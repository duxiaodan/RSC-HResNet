/tmp/slurmd.gpu-g1/job7102217/slurm_script: line 13: activate: No such file or directory
/share/data/vision-greg2/users/xdu/anaconda3/envs/RSC/lib/python3.7/site-packages/tensorflow/python/framework/dtypes.py:516: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_qint8 = np.dtype([("qint8", np.int8, 1)])
/share/data/vision-greg2/users/xdu/anaconda3/envs/RSC/lib/python3.7/site-packages/tensorflow/python/framework/dtypes.py:517: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_quint8 = np.dtype([("quint8", np.uint8, 1)])
/share/data/vision-greg2/users/xdu/anaconda3/envs/RSC/lib/python3.7/site-packages/tensorflow/python/framework/dtypes.py:518: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_qint16 = np.dtype([("qint16", np.int16, 1)])
/share/data/vision-greg2/users/xdu/anaconda3/envs/RSC/lib/python3.7/site-packages/tensorflow/python/framework/dtypes.py:519: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_quint16 = np.dtype([("quint16", np.uint16, 1)])
/share/data/vision-greg2/users/xdu/anaconda3/envs/RSC/lib/python3.7/site-packages/tensorflow/python/framework/dtypes.py:520: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_qint32 = np.dtype([("qint32", np.int32, 1)])
/share/data/vision-greg2/users/xdu/anaconda3/envs/RSC/lib/python3.7/site-packages/tensorflow/python/framework/dtypes.py:525: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  np_resource = np.dtype([("resource", np.ubyte, 1)])
/share/data/vision-greg2/users/xdu/anaconda3/envs/RSC/lib/python3.7/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:541: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_qint8 = np.dtype([("qint8", np.int8, 1)])
/share/data/vision-greg2/users/xdu/anaconda3/envs/RSC/lib/python3.7/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:542: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_quint8 = np.dtype([("quint8", np.uint8, 1)])
/share/data/vision-greg2/users/xdu/anaconda3/envs/RSC/lib/python3.7/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:543: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_qint16 = np.dtype([("qint16", np.int16, 1)])
/share/data/vision-greg2/users/xdu/anaconda3/envs/RSC/lib/python3.7/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:544: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_quint16 = np.dtype([("quint16", np.uint16, 1)])
/share/data/vision-greg2/users/xdu/anaconda3/envs/RSC/lib/python3.7/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:545: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_qint32 = np.dtype([("qint32", np.int32, 1)])
/share/data/vision-greg2/users/xdu/anaconda3/envs/RSC/lib/python3.7/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:550: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  np_resource = np.dtype([("resource", np.ubyte, 1)])
Target domain: sketch
Dataset size: train 5446, val 616, test 3929
Step size: 16
New epoch - lr: 0.01
0/85 of epoch 1/20 class : 3.271 - acc class : 0.00 [bs:128]
30/85 of epoch 1/20 class : 1.475 - acc class : 53.12 [bs:128]
60/85 of epoch 1/20 class : 0.677 - acc class : 73.44 [bs:128]
Accuracies on val: class : 90.58
Accuracies on test: class : 70.55
New epoch - lr: 0.01
0/85 of epoch 2/20 class : 0.681 - acc class : 61.72 [bs:128]
30/85 of epoch 2/20 class : 0.453 - acc class : 92.19 [bs:128]
60/85 of epoch 2/20 class : 0.370 - acc class : 90.62 [bs:128]
Accuracies on val: class : 91.40
Accuracies on test: class : 69.81
New epoch - lr: 0.01
0/85 of epoch 3/20 class : 0.404 - acc class : 79.69 [bs:128]
30/85 of epoch 3/20 class : 0.271 - acc class : 92.19 [bs:128]
60/85 of epoch 3/20 class : 0.293 - acc class : 92.19 [bs:128]
Accuracies on val: class : 92.37
Accuracies on test: class : 75.64
New epoch - lr: 0.01
0/85 of epoch 4/20 class : 0.343 - acc class : 87.50 [bs:128]
30/85 of epoch 4/20 class : 0.255 - acc class : 96.88 [bs:128]
60/85 of epoch 4/20 class : 0.196 - acc class : 94.53 [bs:128]
Accuracies on val: class : 91.40
Accuracies on test: class : 69.99
New epoch - lr: 0.01
0/85 of epoch 5/20 class : 0.171 - acc class : 95.31 [bs:128]
30/85 of epoch 5/20 class : 0.248 - acc class : 91.41 [bs:128]
60/85 of epoch 5/20 class : 0.195 - acc class : 93.75 [bs:128]
Accuracies on val: class : 93.67
Accuracies on test: class : 73.76
New epoch - lr: 0.01
0/85 of epoch 6/20 class : 0.245 - acc class : 92.19 [bs:128]
30/85 of epoch 6/20 class : 0.104 - acc class : 96.88 [bs:128]
60/85 of epoch 6/20 class : 0.145 - acc class : 97.66 [bs:128]
Accuracies on val: class : 94.64
Accuracies on test: class : 75.69
New epoch - lr: 0.01
0/85 of epoch 7/20 class : 0.092 - acc class : 98.44 [bs:128]
30/85 of epoch 7/20 class : 0.202 - acc class : 92.19 [bs:128]
60/85 of epoch 7/20 class : 0.142 - acc class : 94.53 [bs:128]
Accuracies on val: class : 94.16
Accuracies on test: class : 75.08
New epoch - lr: 0.01
0/85 of epoch 8/20 class : 0.312 - acc class : 89.84 [bs:128]
30/85 of epoch 8/20 class : 0.062 - acc class : 98.44 [bs:128]
60/85 of epoch 8/20 class : 0.036 - acc class : 100.00 [bs:128]
Accuracies on val: class : 94.16
Accuracies on test: class : 73.84
New epoch - lr: 0.01
0/85 of epoch 9/20 class : 0.141 - acc class : 98.44 [bs:128]
30/85 of epoch 9/20 class : 0.057 - acc class : 99.22 [bs:128]
60/85 of epoch 9/20 class : 0.117 - acc class : 96.88 [bs:128]
Accuracies on val: class : 94.97
Accuracies on test: class : 78.01
New epoch - lr: 0.01
0/85 of epoch 10/20 class : 0.059 - acc class : 98.44 [bs:128]
30/85 of epoch 10/20 class : 0.071 - acc class : 98.44 [bs:128]
60/85 of epoch 10/20 class : 0.077 - acc class : 97.66 [bs:128]
Accuracies on val: class : 92.21
Accuracies on test: class : 73.61
New epoch - lr: 0.01
0/85 of epoch 11/20 class : 0.066 - acc class : 97.66 [bs:128]
30/85 of epoch 11/20 class : 0.053 - acc class : 98.44 [bs:128]
60/85 of epoch 11/20 class : 0.129 - acc class : 96.88 [bs:128]
Accuracies on val: class : 93.83
Accuracies on test: class : 73.35
New epoch - lr: 0.01
0/85 of epoch 12/20 class : 0.013 - acc class : 100.00 [bs:128]
30/85 of epoch 12/20 class : 0.029 - acc class : 99.22 [bs:128]
60/85 of epoch 12/20 class : 0.117 - acc class : 96.09 [bs:128]
Accuracies on val: class : 94.48
Accuracies on test: class : 80.96
New epoch - lr: 0.01
0/85 of epoch 13/20 class : 0.045 - acc class : 99.22 [bs:128]
30/85 of epoch 13/20 class : 0.093 - acc class : 95.31 [bs:128]
60/85 of epoch 13/20 class : 0.027 - acc class : 99.22 [bs:128]
Accuracies on val: class : 94.64
Accuracies on test: class : 76.99
New epoch - lr: 0.01
0/85 of epoch 14/20 class : 0.027 - acc class : 99.22 [bs:128]
30/85 of epoch 14/20 class : 0.015 - acc class : 100.00 [bs:128]
60/85 of epoch 14/20 class : 0.029 - acc class : 99.22 [bs:128]
Accuracies on val: class : 94.64
Accuracies on test: class : 79.54
New epoch - lr: 0.01
0/85 of epoch 15/20 class : 0.007 - acc class : 100.00 [bs:128]
30/85 of epoch 15/20 class : 0.013 - acc class : 100.00 [bs:128]
60/85 of epoch 15/20 class : 0.017 - acc class : 100.00 [bs:128]
Accuracies on val: class : 94.64
Accuracies on test: class : 75.67
New epoch - lr: 0.01
0/85 of epoch 16/20 class : 0.034 - acc class : 98.44 [bs:128]
30/85 of epoch 16/20 class : 0.043 - acc class : 98.44 [bs:128]
60/85 of epoch 16/20 class : 0.025 - acc class : 99.22 [bs:128]
Accuracies on val: class : 94.32
Accuracies on test: class : 74.80
New epoch - lr: 0.0001
0/85 of epoch 17/20 class : 0.023 - acc class : 100.00 [bs:128]
30/85 of epoch 17/20 class : 0.027 - acc class : 99.22 [bs:128]
60/85 of epoch 17/20 class : 0.036 - acc class : 99.22 [bs:128]
Accuracies on val: class : 95.13
Accuracies on test: class : 76.76
New epoch - lr: 0.001
0/85 of epoch 18/20 class : 0.021 - acc class : 100.00 [bs:128]
30/85 of epoch 18/20 class : 0.026 - acc class : 100.00 [bs:128]
60/85 of epoch 18/20 class : 0.024 - acc class : 100.00 [bs:128]
Accuracies on val: class : 95.78
Accuracies on test: class : 76.13
New epoch - lr: 0.001
0/85 of epoch 19/20 class : 0.028 - acc class : 99.22 [bs:128]
30/85 of epoch 19/20 class : 0.005 - acc class : 100.00 [bs:128]
60/85 of epoch 19/20 class : 0.035 - acc class : 99.22 [bs:128]
Accuracies on val: class : 95.78
Accuracies on test: class : 77.04
New epoch - lr: 0.001
0/85 of epoch 20/20 class : 0.091 - acc class : 98.44 [bs:128]
30/85 of epoch 20/20 class : 0.018 - acc class : 100.00 [bs:128]
60/85 of epoch 20/20 class : 0.007 - acc class : 100.00 [bs:128]
Accuracies on val: class : 95.45
Accuracies on test: class : 76.84
Best val 0.957792, corresponding test 0.770425 - best test: 0.809621, best epoch: 18
It took 501.383
/share/data/vision-greg2/users/xdu/anaconda3/envs/RSC/lib/python3.7/site-packages/tensorflow/python/framework/dtypes.py:516: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_qint8 = np.dtype([("qint8", np.int8, 1)])
/share/data/vision-greg2/users/xdu/anaconda3/envs/RSC/lib/python3.7/site-packages/tensorflow/python/framework/dtypes.py:517: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_quint8 = np.dtype([("quint8", np.uint8, 1)])
/share/data/vision-greg2/users/xdu/anaconda3/envs/RSC/lib/python3.7/site-packages/tensorflow/python/framework/dtypes.py:518: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_qint16 = np.dtype([("qint16", np.int16, 1)])
/share/data/vision-greg2/users/xdu/anaconda3/envs/RSC/lib/python3.7/site-packages/tensorflow/python/framework/dtypes.py:519: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_quint16 = np.dtype([("quint16", np.uint16, 1)])
/share/data/vision-greg2/users/xdu/anaconda3/envs/RSC/lib/python3.7/site-packages/tensorflow/python/framework/dtypes.py:520: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_qint32 = np.dtype([("qint32", np.int32, 1)])
/share/data/vision-greg2/users/xdu/anaconda3/envs/RSC/lib/python3.7/site-packages/tensorflow/python/framework/dtypes.py:525: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  np_resource = np.dtype([("resource", np.ubyte, 1)])
/share/data/vision-greg2/users/xdu/anaconda3/envs/RSC/lib/python3.7/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:541: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_qint8 = np.dtype([("qint8", np.int8, 1)])
/share/data/vision-greg2/users/xdu/anaconda3/envs/RSC/lib/python3.7/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:542: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_quint8 = np.dtype([("quint8", np.uint8, 1)])
/share/data/vision-greg2/users/xdu/anaconda3/envs/RSC/lib/python3.7/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:543: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_qint16 = np.dtype([("qint16", np.int16, 1)])
/share/data/vision-greg2/users/xdu/anaconda3/envs/RSC/lib/python3.7/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:544: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_quint16 = np.dtype([("quint16", np.uint16, 1)])
/share/data/vision-greg2/users/xdu/anaconda3/envs/RSC/lib/python3.7/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:545: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_qint32 = np.dtype([("qint32", np.int32, 1)])
/share/data/vision-greg2/users/xdu/anaconda3/envs/RSC/lib/python3.7/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:550: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  np_resource = np.dtype([("resource", np.ubyte, 1)])
Target domain: sketch
Dataset size: train 5446, val 616, test 3929
Step size: 16
New epoch - lr: 0.01
0/85 of epoch 1/20 class : 3.271 - acc class : 0.00 [bs:128]
30/85 of epoch 1/20 class : 1.610 - acc class : 53.91 [bs:128]
60/85 of epoch 1/20 class : 0.810 - acc class : 64.06 [bs:128]
Accuracies on val: class : 90.42
Accuracies on test: class : 73.10
New epoch - lr: 0.01
0/85 of epoch 2/20 class : 0.679 - acc class : 67.19 [bs:128]
30/85 of epoch 2/20 class : 0.490 - acc class : 85.94 [bs:128]
60/85 of epoch 2/20 class : 0.342 - acc class : 91.41 [bs:128]
Accuracies on val: class : 91.07
Accuracies on test: class : 70.30
New epoch - lr: 0.01
0/85 of epoch 3/20 class : 0.365 - acc class : 85.16 [bs:128]
30/85 of epoch 3/20 class : 0.401 - acc class : 80.47 [bs:128]
60/85 of epoch 3/20 class : 0.284 - acc class : 91.41 [bs:128]
Accuracies on val: class : 93.02
Accuracies on test: class : 67.91
New epoch - lr: 0.01
0/85 of epoch 4/20 class : 0.304 - acc class : 91.41 [bs:128]
30/85 of epoch 4/20 class : 0.299 - acc class : 94.53 [bs:128]
60/85 of epoch 4/20 class : 0.207 - acc class : 93.75 [bs:128]
Accuracies on val: class : 93.51
Accuracies on test: class : 69.84
New epoch - lr: 0.01
0/85 of epoch 5/20 class : 0.228 - acc class : 92.19 [bs:128]
30/85 of epoch 5/20 class : 0.209 - acc class : 94.53 [bs:128]
60/85 of epoch 5/20 class : 0.205 - acc class : 91.41 [bs:128]
Accuracies on val: class : 93.34
Accuracies on test: class : 75.26
New epoch - lr: 0.01
0/85 of epoch 6/20 class : 0.253 - acc class : 92.97 [bs:128]
30/85 of epoch 6/20 class : 0.179 - acc class : 93.75 [bs:128]
60/85 of epoch 6/20 class : 0.120 - acc class : 97.66 [bs:128]
Accuracies on val: class : 95.45
Accuracies on test: class : 72.64
New epoch - lr: 0.01
0/85 of epoch 7/20 class : 0.088 - acc class : 97.66 [bs:128]
30/85 of epoch 7/20 class : 0.302 - acc class : 89.06 [bs:128]
60/85 of epoch 7/20 class : 0.148 - acc class : 94.53 [bs:128]
Accuracies on val: class : 93.67
Accuracies on test: class : 74.75
New epoch - lr: 0.01
0/85 of epoch 8/20 class : 0.258 - acc class : 93.75 [bs:128]
30/85 of epoch 8/20 class : 0.068 - acc class : 98.44 [bs:128]
60/85 of epoch 8/20 class : 0.049 - acc class : 98.44 [bs:128]
Accuracies on val: class : 92.21
Accuracies on test: class : 74.45
New epoch - lr: 0.01
0/85 of epoch 9/20 class : 0.077 - acc class : 98.44 [bs:128]
30/85 of epoch 9/20 class : 0.036 - acc class : 100.00 [bs:128]
60/85 of epoch 9/20 class : 0.121 - acc class : 96.88 [bs:128]
Accuracies on val: class : 93.67
Accuracies on test: class : 82.31
New epoch - lr: 0.01
0/85 of epoch 10/20 class : 0.062 - acc class : 97.66 [bs:128]
30/85 of epoch 10/20 class : 0.065 - acc class : 98.44 [bs:128]
60/85 of epoch 10/20 class : 0.043 - acc class : 99.22 [bs:128]
Accuracies on val: class : 95.62
Accuracies on test: class : 78.80
New epoch - lr: 0.01
0/85 of epoch 11/20 class : 0.057 - acc class : 98.44 [bs:128]
30/85 of epoch 11/20 class : 0.044 - acc class : 99.22 [bs:128]
60/85 of epoch 11/20 class : 0.040 - acc class : 100.00 [bs:128]
Accuracies on val: class : 93.51
Accuracies on test: class : 78.85
New epoch - lr: 0.01
0/85 of epoch 12/20 class : 0.018 - acc class : 100.00 [bs:128]
30/85 of epoch 12/20 class : 0.032 - acc class : 100.00 [bs:128]
60/85 of epoch 12/20 class : 0.165 - acc class : 96.88 [bs:128]
Accuracies on val: class : 91.88
Accuracies on test: class : 81.73
New epoch - lr: 0.01
0/85 of epoch 13/20 class : 0.135 - acc class : 99.22 [bs:128]
30/85 of epoch 13/20 class : 0.044 - acc class : 98.44 [bs:128]
60/85 of epoch 13/20 class : 0.041 - acc class : 99.22 [bs:128]
Accuracies on val: class : 94.64
Accuracies on test: class : 78.93
New epoch - lr: 0.01
0/85 of epoch 14/20 class : 0.034 - acc class : 98.44 [bs:128]
30/85 of epoch 14/20 class : 0.014 - acc class : 100.00 [bs:128]
60/85 of epoch 14/20 class : 0.048 - acc class : 98.44 [bs:128]
Accuracies on val: class : 94.64
Accuracies on test: class : 79.49
New epoch - lr: 0.01
0/85 of epoch 15/20 class : 0.013 - acc class : 100.00 [bs:128]
30/85 of epoch 15/20 class : 0.050 - acc class : 97.66 [bs:128]
60/85 of epoch 15/20 class : 0.014 - acc class : 100.00 [bs:128]
Accuracies on val: class : 94.32
Accuracies on test: class : 81.57
New epoch - lr: 0.01
0/85 of epoch 16/20 class : 0.020 - acc class : 100.00 [bs:128]
30/85 of epoch 16/20 class : 0.053 - acc class : 96.88 [bs:128]
60/85 of epoch 16/20 class : 0.047 - acc class : 99.22 [bs:128]
Accuracies on val: class : 94.32
Accuracies on test: class : 77.86
New epoch - lr: 0.0001
0/85 of epoch 17/20 class : 0.022 - acc class : 99.22 [bs:128]
30/85 of epoch 17/20 class : 0.019 - acc class : 99.22 [bs:128]
60/85 of epoch 17/20 class : 0.019 - acc class : 100.00 [bs:128]
Accuracies on val: class : 95.78
Accuracies on test: class : 78.80
New epoch - lr: 0.001
0/85 of epoch 18/20 class : 0.027 - acc class : 98.44 [bs:128]
30/85 of epoch 18/20 class : 0.009 - acc class : 100.00 [bs:128]
60/85 of epoch 18/20 class : 0.023 - acc class : 100.00 [bs:128]
Accuracies on val: class : 95.13
Accuracies on test: class : 79.84
New epoch - lr: 0.001
0/85 of epoch 19/20 class : 0.017 - acc class : 100.00 [bs:128]
30/85 of epoch 19/20 class : 0.005 - acc class : 100.00 [bs:128]
60/85 of epoch 19/20 class : 0.015 - acc class : 100.00 [bs:128]
Accuracies on val: class : 95.45
Accuracies on test: class : 80.05
New epoch - lr: 0.001
0/85 of epoch 20/20 class : 0.005 - acc class : 100.00 [bs:128]
30/85 of epoch 20/20 class : 0.007 - acc class : 100.00 [bs:128]
60/85 of epoch 20/20 class : 0.006 - acc class : 100.00 [bs:128]
Accuracies on val: class : 95.94
Accuracies on test: class : 79.87
Best val 0.959416, corresponding test 0.798676 - best test: 0.82311, best epoch: 19
It took 475.46
/share/data/vision-greg2/users/xdu/anaconda3/envs/RSC/lib/python3.7/site-packages/tensorflow/python/framework/dtypes.py:516: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_qint8 = np.dtype([("qint8", np.int8, 1)])
/share/data/vision-greg2/users/xdu/anaconda3/envs/RSC/lib/python3.7/site-packages/tensorflow/python/framework/dtypes.py:517: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_quint8 = np.dtype([("quint8", np.uint8, 1)])
/share/data/vision-greg2/users/xdu/anaconda3/envs/RSC/lib/python3.7/site-packages/tensorflow/python/framework/dtypes.py:518: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_qint16 = np.dtype([("qint16", np.int16, 1)])
/share/data/vision-greg2/users/xdu/anaconda3/envs/RSC/lib/python3.7/site-packages/tensorflow/python/framework/dtypes.py:519: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_quint16 = np.dtype([("quint16", np.uint16, 1)])
/share/data/vision-greg2/users/xdu/anaconda3/envs/RSC/lib/python3.7/site-packages/tensorflow/python/framework/dtypes.py:520: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_qint32 = np.dtype([("qint32", np.int32, 1)])
/share/data/vision-greg2/users/xdu/anaconda3/envs/RSC/lib/python3.7/site-packages/tensorflow/python/framework/dtypes.py:525: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  np_resource = np.dtype([("resource", np.ubyte, 1)])
/share/data/vision-greg2/users/xdu/anaconda3/envs/RSC/lib/python3.7/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:541: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_qint8 = np.dtype([("qint8", np.int8, 1)])
/share/data/vision-greg2/users/xdu/anaconda3/envs/RSC/lib/python3.7/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:542: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_quint8 = np.dtype([("quint8", np.uint8, 1)])
/share/data/vision-greg2/users/xdu/anaconda3/envs/RSC/lib/python3.7/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:543: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_qint16 = np.dtype([("qint16", np.int16, 1)])
/share/data/vision-greg2/users/xdu/anaconda3/envs/RSC/lib/python3.7/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:544: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_quint16 = np.dtype([("quint16", np.uint16, 1)])
/share/data/vision-greg2/users/xdu/anaconda3/envs/RSC/lib/python3.7/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:545: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_qint32 = np.dtype([("qint32", np.int32, 1)])
/share/data/vision-greg2/users/xdu/anaconda3/envs/RSC/lib/python3.7/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:550: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  np_resource = np.dtype([("resource", np.ubyte, 1)])
Target domain: sketch
Dataset size: train 5446, val 616, test 3929
Step size: 16
New epoch - lr: 0.01
0/85 of epoch 1/20 class : 2.109 - acc class : 5.47 [bs:128]
30/85 of epoch 1/20 class : 1.540 - acc class : 56.25 [bs:128]
60/85 of epoch 1/20 class : 0.490 - acc class : 84.38 [bs:128]
Accuracies on val: class : 89.29
Accuracies on test: class : 72.41
New epoch - lr: 0.01
0/85 of epoch 2/20 class : 0.467 - acc class : 84.38 [bs:128]
30/85 of epoch 2/20 class : 0.638 - acc class : 71.09 [bs:128]
60/85 of epoch 2/20 class : 0.351 - acc class : 89.06 [bs:128]
Accuracies on val: class : 92.53
Accuracies on test: class : 69.64
New epoch - lr: 0.01
0/85 of epoch 3/20 class : 0.397 - acc class : 85.16 [bs:128]
30/85 of epoch 3/20 class : 0.350 - acc class : 84.38 [bs:128]
60/85 of epoch 3/20 class : 0.438 - acc class : 84.38 [bs:128]
Accuracies on val: class : 92.86
Accuracies on test: class : 72.31
New epoch - lr: 0.01
0/85 of epoch 4/20 class : 0.304 - acc class : 88.28 [bs:128]
30/85 of epoch 4/20 class : 0.266 - acc class : 96.09 [bs:128]
60/85 of epoch 4/20 class : 0.212 - acc class : 92.19 [bs:128]
Accuracies on val: class : 94.81
Accuracies on test: class : 73.86
New epoch - lr: 0.01
0/85 of epoch 5/20 class : 0.197 - acc class : 93.75 [bs:128]
30/85 of epoch 5/20 class : 0.239 - acc class : 92.97 [bs:128]
60/85 of epoch 5/20 class : 0.264 - acc class : 88.28 [bs:128]
Accuracies on val: class : 93.18
Accuracies on test: class : 72.69
New epoch - lr: 0.01
0/85 of epoch 6/20 class : 0.275 - acc class : 90.62 [bs:128]
30/85 of epoch 6/20 class : 0.152 - acc class : 96.09 [bs:128]
60/85 of epoch 6/20 class : 0.138 - acc class : 96.88 [bs:128]
Accuracies on val: class : 89.45
Accuracies on test: class : 51.34
New epoch - lr: 0.01
0/85 of epoch 7/20 class : 0.142 - acc class : 97.66 [bs:128]
30/85 of epoch 7/20 class : 0.160 - acc class : 95.31 [bs:128]
60/85 of epoch 7/20 class : 0.119 - acc class : 93.75 [bs:128]
Accuracies on val: class : 95.94
Accuracies on test: class : 79.36
New epoch - lr: 0.01
0/85 of epoch 8/20 class : 0.214 - acc class : 92.97 [bs:128]
30/85 of epoch 8/20 class : 0.087 - acc class : 96.88 [bs:128]
60/85 of epoch 8/20 class : 0.047 - acc class : 100.00 [bs:128]
Accuracies on val: class : 94.32
Accuracies on test: class : 75.49
New epoch - lr: 0.01
0/85 of epoch 9/20 class : 0.047 - acc class : 99.22 [bs:128]
30/85 of epoch 9/20 class : 0.038 - acc class : 100.00 [bs:128]
60/85 of epoch 9/20 class : 0.152 - acc class : 96.09 [bs:128]
Accuracies on val: class : 93.67
Accuracies on test: class : 74.47
New epoch - lr: 0.01
0/85 of epoch 10/20 class : 0.054 - acc class : 99.22 [bs:128]
30/85 of epoch 10/20 class : 0.089 - acc class : 97.66 [bs:128]
60/85 of epoch 10/20 class : 0.078 - acc class : 96.88 [bs:128]
Accuracies on val: class : 94.81
Accuracies on test: class : 79.36
New epoch - lr: 0.01
0/85 of epoch 11/20 class : 0.195 - acc class : 94.53 [bs:128]
30/85 of epoch 11/20 class : 0.034 - acc class : 100.00 [bs:128]
60/85 of epoch 11/20 class : 0.061 - acc class : 97.66 [bs:128]
Accuracies on val: class : 93.51
Accuracies on test: class : 75.54
New epoch - lr: 0.01
0/85 of epoch 12/20 class : 0.022 - acc class : 100.00 [bs:128]
30/85 of epoch 12/20 class : 0.043 - acc class : 98.44 [bs:128]
60/85 of epoch 12/20 class : 0.107 - acc class : 95.31 [bs:128]
Accuracies on val: class : 94.81
Accuracies on test: class : 78.80
New epoch - lr: 0.01
0/85 of epoch 13/20 class : 0.044 - acc class : 97.66 [bs:128]
30/85 of epoch 13/20 class : 0.040 - acc class : 100.00 [bs:128]
60/85 of epoch 13/20 class : 0.061 - acc class : 97.66 [bs:128]
Accuracies on val: class : 95.13
Accuracies on test: class : 73.48
New epoch - lr: 0.01
0/85 of epoch 14/20 class : 0.053 - acc class : 98.44 [bs:128]
30/85 of epoch 14/20 class : 0.033 - acc class : 99.22 [bs:128]
60/85 of epoch 14/20 class : 0.063 - acc class : 99.22 [bs:128]
Accuracies on val: class : 95.13
Accuracies on test: class : 76.84
New epoch - lr: 0.01
0/85 of epoch 15/20 class : 0.016 - acc class : 100.00 [bs:128]
30/85 of epoch 15/20 class : 0.039 - acc class : 98.44 [bs:128]
60/85 of epoch 15/20 class : 0.008 - acc class : 100.00 [bs:128]
Accuracies on val: class : 93.99
Accuracies on test: class : 80.45
New epoch - lr: 0.01
0/85 of epoch 16/20 class : 0.009 - acc class : 100.00 [bs:128]
30/85 of epoch 16/20 class : 0.070 - acc class : 97.66 [bs:128]
60/85 of epoch 16/20 class : 0.031 - acc class : 99.22 [bs:128]
Accuracies on val: class : 93.83
Accuracies on test: class : 73.20
New epoch - lr: 0.0001
0/85 of epoch 17/20 class : 0.022 - acc class : 99.22 [bs:128]
30/85 of epoch 17/20 class : 0.025 - acc class : 99.22 [bs:128]
60/85 of epoch 17/20 class : 0.033 - acc class : 98.44 [bs:128]
Accuracies on val: class : 96.75
Accuracies on test: class : 79.18
New epoch - lr: 0.001
0/85 of epoch 18/20 class : 0.014 - acc class : 100.00 [bs:128]
30/85 of epoch 18/20 class : 0.048 - acc class : 96.88 [bs:128]
60/85 of epoch 18/20 class : 0.014 - acc class : 100.00 [bs:128]
Accuracies on val: class : 96.43
Accuracies on test: class : 80.25
New epoch - lr: 0.001
0/85 of epoch 19/20 class : 0.019 - acc class : 100.00 [bs:128]
30/85 of epoch 19/20 class : 0.007 - acc class : 100.00 [bs:128]
60/85 of epoch 19/20 class : 0.038 - acc class : 98.44 [bs:128]
Accuracies on val: class : 96.92
Accuracies on test: class : 80.45
New epoch - lr: 0.001
0/85 of epoch 20/20 class : 0.009 - acc class : 100.00 [bs:128]
30/85 of epoch 20/20 class : 0.011 - acc class : 100.00 [bs:128]
60/85 of epoch 20/20 class : 0.016 - acc class : 100.00 [bs:128]
Accuracies on val: class : 96.75
Accuracies on test: class : 80.86
Best val 0.969156, corresponding test 0.80453 - best test: 0.808603, best epoch: 18
It took 467.315
/share/data/vision-greg2/users/xdu/anaconda3/envs/RSC/lib/python3.7/site-packages/tensorflow/python/framework/dtypes.py:516: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_qint8 = np.dtype([("qint8", np.int8, 1)])
/share/data/vision-greg2/users/xdu/anaconda3/envs/RSC/lib/python3.7/site-packages/tensorflow/python/framework/dtypes.py:517: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_quint8 = np.dtype([("quint8", np.uint8, 1)])
/share/data/vision-greg2/users/xdu/anaconda3/envs/RSC/lib/python3.7/site-packages/tensorflow/python/framework/dtypes.py:518: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_qint16 = np.dtype([("qint16", np.int16, 1)])
/share/data/vision-greg2/users/xdu/anaconda3/envs/RSC/lib/python3.7/site-packages/tensorflow/python/framework/dtypes.py:519: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_quint16 = np.dtype([("quint16", np.uint16, 1)])
/share/data/vision-greg2/users/xdu/anaconda3/envs/RSC/lib/python3.7/site-packages/tensorflow/python/framework/dtypes.py:520: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_qint32 = np.dtype([("qint32", np.int32, 1)])
/share/data/vision-greg2/users/xdu/anaconda3/envs/RSC/lib/python3.7/site-packages/tensorflow/python/framework/dtypes.py:525: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  np_resource = np.dtype([("resource", np.ubyte, 1)])
/share/data/vision-greg2/users/xdu/anaconda3/envs/RSC/lib/python3.7/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:541: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_qint8 = np.dtype([("qint8", np.int8, 1)])
/share/data/vision-greg2/users/xdu/anaconda3/envs/RSC/lib/python3.7/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:542: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_quint8 = np.dtype([("quint8", np.uint8, 1)])
/share/data/vision-greg2/users/xdu/anaconda3/envs/RSC/lib/python3.7/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:543: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_qint16 = np.dtype([("qint16", np.int16, 1)])
/share/data/vision-greg2/users/xdu/anaconda3/envs/RSC/lib/python3.7/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:544: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_quint16 = np.dtype([("quint16", np.uint16, 1)])
/share/data/vision-greg2/users/xdu/anaconda3/envs/RSC/lib/python3.7/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:545: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_qint32 = np.dtype([("qint32", np.int32, 1)])
/share/data/vision-greg2/users/xdu/anaconda3/envs/RSC/lib/python3.7/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:550: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  np_resource = np.dtype([("resource", np.ubyte, 1)])
Target domain: sketch
Dataset size: train 5446, val 616, test 3929
Step size: 16
New epoch - lr: 0.01
0/85 of epoch 1/20 class : 3.271 - acc class : 0.00 [bs:128]
30/85 of epoch 1/20 class : 0.909 - acc class : 77.34 [bs:128]
60/85 of epoch 1/20 class : 0.473 - acc class : 86.72 [bs:128]
Accuracies on val: class : 90.10
Accuracies on test: class : 72.05
New epoch - lr: 0.01
0/85 of epoch 2/20 class : 0.571 - acc class : 87.50 [bs:128]
30/85 of epoch 2/20 class : 0.701 - acc class : 69.53 [bs:128]
60/85 of epoch 2/20 class : 0.383 - acc class : 89.84 [bs:128]
Accuracies on val: class : 90.42
Accuracies on test: class : 71.82
New epoch - lr: 0.01
0/85 of epoch 3/20 class : 0.301 - acc class : 91.41 [bs:128]
30/85 of epoch 3/20 class : 0.363 - acc class : 81.25 [bs:128]
60/85 of epoch 3/20 class : 0.361 - acc class : 86.72 [bs:128]
Accuracies on val: class : 94.16
Accuracies on test: class : 72.36
New epoch - lr: 0.01
0/85 of epoch 4/20 class : 0.292 - acc class : 86.72 [bs:128]
30/85 of epoch 4/20 class : 0.257 - acc class : 91.41 [bs:128]
60/85 of epoch 4/20 class : 0.219 - acc class : 92.19 [bs:128]
Accuracies on val: class : 93.99
Accuracies on test: class : 73.35
New epoch - lr: 0.01
0/85 of epoch 5/20 class : 0.162 - acc class : 98.44 [bs:128]
30/85 of epoch 5/20 class : 0.291 - acc class : 89.06 [bs:128]
60/85 of epoch 5/20 class : 0.168 - acc class : 95.31 [bs:128]
Accuracies on val: class : 95.29
Accuracies on test: class : 73.43
New epoch - lr: 0.01
0/85 of epoch 6/20 class : 0.197 - acc class : 95.31 [bs:128]
30/85 of epoch 6/20 class : 0.195 - acc class : 91.41 [bs:128]
60/85 of epoch 6/20 class : 0.144 - acc class : 96.09 [bs:128]
Accuracies on val: class : 92.69
Accuracies on test: class : 64.04
New epoch - lr: 0.01
0/85 of epoch 7/20 class : 0.117 - acc class : 98.44 [bs:128]
30/85 of epoch 7/20 class : 0.168 - acc class : 92.97 [bs:128]
60/85 of epoch 7/20 class : 0.119 - acc class : 96.09 [bs:128]
Accuracies on val: class : 95.62
Accuracies on test: class : 76.15
New epoch - lr: 0.01
0/85 of epoch 8/20 class : 0.162 - acc class : 95.31 [bs:128]
30/85 of epoch 8/20 class : 0.045 - acc class : 99.22 [bs:128]
60/85 of epoch 8/20 class : 0.048 - acc class : 98.44 [bs:128]
Accuracies on val: class : 95.29
Accuracies on test: class : 76.94
New epoch - lr: 0.01
0/85 of epoch 9/20 class : 0.038 - acc class : 100.00 [bs:128]
30/85 of epoch 9/20 class : 0.083 - acc class : 97.66 [bs:128]
60/85 of epoch 9/20 class : 0.138 - acc class : 95.31 [bs:128]
Accuracies on val: class : 93.67
Accuracies on test: class : 78.85
New epoch - lr: 0.01
0/85 of epoch 10/20 class : 0.104 - acc class : 96.88 [bs:128]
30/85 of epoch 10/20 class : 0.104 - acc class : 96.88 [bs:128]
60/85 of epoch 10/20 class : 0.018 - acc class : 100.00 [bs:128]
Accuracies on val: class : 94.64
Accuracies on test: class : 81.39
New epoch - lr: 0.01
0/85 of epoch 11/20 class : 0.141 - acc class : 98.44 [bs:128]
30/85 of epoch 11/20 class : 0.030 - acc class : 100.00 [bs:128]
60/85 of epoch 11/20 class : 0.049 - acc class : 99.22 [bs:128]
Accuracies on val: class : 93.83
Accuracies on test: class : 77.78
New epoch - lr: 0.01
0/85 of epoch 12/20 class : 0.031 - acc class : 100.00 [bs:128]
30/85 of epoch 12/20 class : 0.046 - acc class : 98.44 [bs:128]
60/85 of epoch 12/20 class : 0.130 - acc class : 94.53 [bs:128]
Accuracies on val: class : 95.62
Accuracies on test: class : 75.97
New epoch - lr: 0.01
0/85 of epoch 13/20 class : 0.074 - acc class : 96.88 [bs:128]
30/85 of epoch 13/20 class : 0.091 - acc class : 96.09 [bs:128]
60/85 of epoch 13/20 class : 0.049 - acc class : 99.22 [bs:128]
Accuracies on val: class : 95.29
Accuracies on test: class : 76.66
New epoch - lr: 0.01
0/85 of epoch 14/20 class : 0.046 - acc class : 98.44 [bs:128]
30/85 of epoch 14/20 class : 0.044 - acc class : 99.22 [bs:128]
60/85 of epoch 14/20 class : 0.024 - acc class : 99.22 [bs:128]
Accuracies on val: class : 95.29
Accuracies on test: class : 76.46
New epoch - lr: 0.01
0/85 of epoch 15/20 class : 0.014 - acc class : 100.00 [bs:128]
30/85 of epoch 15/20 class : 0.029 - acc class : 99.22 [bs:128]
60/85 of epoch 15/20 class : 0.014 - acc class : 100.00 [bs:128]
Accuracies on val: class : 94.48
Accuracies on test: class : 71.47
New epoch - lr: 0.01
0/85 of epoch 16/20 class : 0.087 - acc class : 97.66 [bs:128]
30/85 of epoch 16/20 class : 0.058 - acc class : 96.88 [bs:128]
60/85 of epoch 16/20 class : 0.046 - acc class : 99.22 [bs:128]
Accuracies on val: class : 93.99
Accuracies on test: class : 79.82
New epoch - lr: 0.0001
0/85 of epoch 17/20 class : 0.020 - acc class : 99.22 [bs:128]
30/85 of epoch 17/20 class : 0.017 - acc class : 100.00 [bs:128]
60/85 of epoch 17/20 class : 0.040 - acc class : 98.44 [bs:128]
Accuracies on val: class : 95.29
Accuracies on test: class : 78.57
New epoch - lr: 0.001
0/85 of epoch 18/20 class : 0.031 - acc class : 99.22 [bs:128]
30/85 of epoch 18/20 class : 0.016 - acc class : 100.00 [bs:128]
60/85 of epoch 18/20 class : 0.017 - acc class : 100.00 [bs:128]
Accuracies on val: class : 95.78
Accuracies on test: class : 79.56
New epoch - lr: 0.001
0/85 of epoch 19/20 class : 0.012 - acc class : 100.00 [bs:128]
30/85 of epoch 19/20 class : 0.011 - acc class : 100.00 [bs:128]
60/85 of epoch 19/20 class : 0.015 - acc class : 100.00 [bs:128]
Accuracies on val: class : 95.78
Accuracies on test: class : 80.20
New epoch - lr: 0.001
0/85 of epoch 20/20 class : 0.016 - acc class : 100.00 [bs:128]
30/85 of epoch 20/20 class : 0.006 - acc class : 100.00 [bs:128]
60/85 of epoch 20/20 class : 0.027 - acc class : 100.00 [bs:128]
Accuracies on val: class : 96.10
Accuracies on test: class : 80.17
Best val 0.961039, corresponding test 0.801731 - best test: 0.813948, best epoch: 19
It took 471.531
/share/data/vision-greg2/users/xdu/anaconda3/envs/RSC/lib/python3.7/site-packages/tensorflow/python/framework/dtypes.py:516: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_qint8 = np.dtype([("qint8", np.int8, 1)])
/share/data/vision-greg2/users/xdu/anaconda3/envs/RSC/lib/python3.7/site-packages/tensorflow/python/framework/dtypes.py:517: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_quint8 = np.dtype([("quint8", np.uint8, 1)])
/share/data/vision-greg2/users/xdu/anaconda3/envs/RSC/lib/python3.7/site-packages/tensorflow/python/framework/dtypes.py:518: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_qint16 = np.dtype([("qint16", np.int16, 1)])
/share/data/vision-greg2/users/xdu/anaconda3/envs/RSC/lib/python3.7/site-packages/tensorflow/python/framework/dtypes.py:519: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_quint16 = np.dtype([("quint16", np.uint16, 1)])
/share/data/vision-greg2/users/xdu/anaconda3/envs/RSC/lib/python3.7/site-packages/tensorflow/python/framework/dtypes.py:520: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_qint32 = np.dtype([("qint32", np.int32, 1)])
/share/data/vision-greg2/users/xdu/anaconda3/envs/RSC/lib/python3.7/site-packages/tensorflow/python/framework/dtypes.py:525: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  np_resource = np.dtype([("resource", np.ubyte, 1)])
/share/data/vision-greg2/users/xdu/anaconda3/envs/RSC/lib/python3.7/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:541: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_qint8 = np.dtype([("qint8", np.int8, 1)])
/share/data/vision-greg2/users/xdu/anaconda3/envs/RSC/lib/python3.7/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:542: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_quint8 = np.dtype([("quint8", np.uint8, 1)])
/share/data/vision-greg2/users/xdu/anaconda3/envs/RSC/lib/python3.7/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:543: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_qint16 = np.dtype([("qint16", np.int16, 1)])
/share/data/vision-greg2/users/xdu/anaconda3/envs/RSC/lib/python3.7/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:544: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_quint16 = np.dtype([("quint16", np.uint16, 1)])
/share/data/vision-greg2/users/xdu/anaconda3/envs/RSC/lib/python3.7/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:545: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_qint32 = np.dtype([("qint32", np.int32, 1)])
/share/data/vision-greg2/users/xdu/anaconda3/envs/RSC/lib/python3.7/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:550: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  np_resource = np.dtype([("resource", np.ubyte, 1)])
Target domain: sketch
Dataset size: train 5446, val 616, test 3929
Step size: 16
New epoch - lr: 0.01
0/85 of epoch 1/20 class : 3.271 - acc class : 0.00 [bs:128]
30/85 of epoch 1/20 class : 0.911 - acc class : 74.22 [bs:128]
60/85 of epoch 1/20 class : 0.497 - acc class : 86.72 [bs:128]
Accuracies on val: class : 89.45
Accuracies on test: class : 67.78
New epoch - lr: 0.01
0/85 of epoch 2/20 class : 0.690 - acc class : 67.97 [bs:128]
30/85 of epoch 2/20 class : 0.652 - acc class : 72.66 [bs:128]
60/85 of epoch 2/20 class : 0.325 - acc class : 91.41 [bs:128]
Accuracies on val: class : 89.45
Accuracies on test: class : 70.78
New epoch - lr: 0.01
0/85 of epoch 3/20 class : 0.332 - acc class : 92.19 [bs:128]
30/85 of epoch 3/20 class : 0.307 - acc class : 86.72 [bs:128]
60/85 of epoch 3/20 class : 0.310 - acc class : 91.41 [bs:128]
Accuracies on val: class : 93.67
Accuracies on test: class : 70.22
New epoch - lr: 0.01
0/85 of epoch 4/20 class : 0.321 - acc class : 92.97 [bs:128]
30/85 of epoch 4/20 class : 0.261 - acc class : 92.97 [bs:128]
60/85 of epoch 4/20 class : 0.208 - acc class : 95.31 [bs:128]
Accuracies on val: class : 94.64
Accuracies on test: class : 73.22
New epoch - lr: 0.01
0/85 of epoch 5/20 class : 0.164 - acc class : 96.88 [bs:128]
30/85 of epoch 5/20 class : 0.222 - acc class : 92.97 [bs:128]
60/85 of epoch 5/20 class : 0.200 - acc class : 93.75 [bs:128]
Accuracies on val: class : 94.97
Accuracies on test: class : 79.71
New epoch - lr: 0.01
0/85 of epoch 6/20 class : 0.227 - acc class : 94.53 [bs:128]
30/85 of epoch 6/20 class : 0.192 - acc class : 93.75 [bs:128]
60/85 of epoch 6/20 class : 0.158 - acc class : 97.66 [bs:128]
Accuracies on val: class : 92.05
Accuracies on test: class : 70.37
New epoch - lr: 0.01
0/85 of epoch 7/20 class : 0.051 - acc class : 100.00 [bs:128]
30/85 of epoch 7/20 class : 0.227 - acc class : 90.62 [bs:128]
60/85 of epoch 7/20 class : 0.100 - acc class : 96.88 [bs:128]
Accuracies on val: class : 92.53
Accuracies on test: class : 78.65
New epoch - lr: 0.01
0/85 of epoch 8/20 class : 0.240 - acc class : 95.31 [bs:128]
30/85 of epoch 8/20 class : 0.042 - acc class : 100.00 [bs:128]
60/85 of epoch 8/20 class : 0.042 - acc class : 99.22 [bs:128]
Accuracies on val: class : 93.18
Accuracies on test: class : 74.47
New epoch - lr: 0.01
0/85 of epoch 9/20 class : 0.165 - acc class : 97.66 [bs:128]
30/85 of epoch 9/20 class : 0.069 - acc class : 98.44 [bs:128]
60/85 of epoch 9/20 class : 0.173 - acc class : 93.75 [bs:128]
Accuracies on val: class : 93.67
Accuracies on test: class : 77.53
New epoch - lr: 0.01
0/85 of epoch 10/20 class : 0.063 - acc class : 98.44 [bs:128]
30/85 of epoch 10/20 class : 0.069 - acc class : 99.22 [bs:128]
60/85 of epoch 10/20 class : 0.070 - acc class : 97.66 [bs:128]
Accuracies on val: class : 94.16
Accuracies on test: class : 79.56
New epoch - lr: 0.01
0/85 of epoch 11/20 class : 0.118 - acc class : 97.66 [bs:128]
30/85 of epoch 11/20 class : 0.028 - acc class : 99.22 [bs:128]
60/85 of epoch 11/20 class : 0.033 - acc class : 100.00 [bs:128]
Accuracies on val: class : 94.48
Accuracies on test: class : 73.50
New epoch - lr: 0.01
0/85 of epoch 12/20 class : 0.025 - acc class : 100.00 [bs:128]
30/85 of epoch 12/20 class : 0.075 - acc class : 97.66 [bs:128]
60/85 of epoch 12/20 class : 0.028 - acc class : 99.22 [bs:128]
Accuracies on val: class : 95.45
Accuracies on test: class : 77.42
New epoch - lr: 0.01
0/85 of epoch 13/20 class : 0.072 - acc class : 96.88 [bs:128]
30/85 of epoch 13/20 class : 0.054 - acc class : 96.88 [bs:128]
60/85 of epoch 13/20 class : 0.075 - acc class : 96.88 [bs:128]
Accuracies on val: class : 94.64
Accuracies on test: class : 78.32
New epoch - lr: 0.01
0/85 of epoch 14/20 class : 0.048 - acc class : 97.66 [bs:128]
30/85 of epoch 14/20 class : 0.009 - acc class : 100.00 [bs:128]
60/85 of epoch 14/20 class : 0.035 - acc class : 99.22 [bs:128]
Accuracies on val: class : 93.99
Accuracies on test: class : 79.74
New epoch - lr: 0.01
0/85 of epoch 15/20 class : 0.010 - acc class : 100.00 [bs:128]
30/85 of epoch 15/20 class : 0.024 - acc class : 99.22 [bs:128]
60/85 of epoch 15/20 class : 0.012 - acc class : 100.00 [bs:128]
Accuracies on val: class : 94.32
Accuracies on test: class : 74.12
New epoch - lr: 0.01
0/85 of epoch 16/20 class : 0.017 - acc class : 100.00 [bs:128]
30/85 of epoch 16/20 class : 0.075 - acc class : 97.66 [bs:128]
60/85 of epoch 16/20 class : 0.030 - acc class : 98.44 [bs:128]
Accuracies on val: class : 94.81
Accuracies on test: class : 81.88
New epoch - lr: 0.0001
0/85 of epoch 17/20 class : 0.029 - acc class : 99.22 [bs:128]
30/85 of epoch 17/20 class : 0.027 - acc class : 99.22 [bs:128]
60/85 of epoch 17/20 class : 0.019 - acc class : 100.00 [bs:128]
Accuracies on val: class : 95.62
Accuracies on test: class : 82.06
New epoch - lr: 0.001
0/85 of epoch 18/20 class : 0.027 - acc class : 99.22 [bs:128]
30/85 of epoch 18/20 class : 0.028 - acc class : 98.44 [bs:128]
60/85 of epoch 18/20 class : 0.016 - acc class : 100.00 [bs:128]
Accuracies on val: class : 95.13
Accuracies on test: class : 81.75
New epoch - lr: 0.001
0/85 of epoch 19/20 class : 0.030 - acc class : 98.44 [bs:128]
30/85 of epoch 19/20 class : 0.003 - acc class : 100.00 [bs:128]
60/85 of epoch 19/20 class : 0.011 - acc class : 100.00 [bs:128]
Accuracies on val: class : 95.29
Accuracies on test: class : 82.77
New epoch - lr: 0.001
0/85 of epoch 20/20 class : 0.006 - acc class : 100.00 [bs:128]
30/85 of epoch 20/20 class : 0.012 - acc class : 100.00 [bs:128]
60/85 of epoch 20/20 class : 0.014 - acc class : 100.00 [bs:128]
Accuracies on val: class : 95.78
Accuracies on test: class : 82.46
Best val 0.957792, corresponding test 0.824637 - best test: 0.827691, best epoch: 19
It took 481.827
