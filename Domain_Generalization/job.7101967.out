/tmp/slurmd.gpu-g15/job7101967/slurm_script: line 13: activate: No such file or directory
/share/data/vision-greg2/users/xdu/anaconda3/envs/RSC/lib/python3.7/site-packages/tensorflow/python/framework/dtypes.py:516: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_qint8 = np.dtype([("qint8", np.int8, 1)])
/share/data/vision-greg2/users/xdu/anaconda3/envs/RSC/lib/python3.7/site-packages/tensorflow/python/framework/dtypes.py:517: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_quint8 = np.dtype([("quint8", np.uint8, 1)])
/share/data/vision-greg2/users/xdu/anaconda3/envs/RSC/lib/python3.7/site-packages/tensorflow/python/framework/dtypes.py:518: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_qint16 = np.dtype([("qint16", np.int16, 1)])
/share/data/vision-greg2/users/xdu/anaconda3/envs/RSC/lib/python3.7/site-packages/tensorflow/python/framework/dtypes.py:519: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_quint16 = np.dtype([("quint16", np.uint16, 1)])
/share/data/vision-greg2/users/xdu/anaconda3/envs/RSC/lib/python3.7/site-packages/tensorflow/python/framework/dtypes.py:520: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_qint32 = np.dtype([("qint32", np.int32, 1)])
/share/data/vision-greg2/users/xdu/anaconda3/envs/RSC/lib/python3.7/site-packages/tensorflow/python/framework/dtypes.py:525: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  np_resource = np.dtype([("resource", np.ubyte, 1)])
/share/data/vision-greg2/users/xdu/anaconda3/envs/RSC/lib/python3.7/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:541: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_qint8 = np.dtype([("qint8", np.int8, 1)])
/share/data/vision-greg2/users/xdu/anaconda3/envs/RSC/lib/python3.7/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:542: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_quint8 = np.dtype([("quint8", np.uint8, 1)])
/share/data/vision-greg2/users/xdu/anaconda3/envs/RSC/lib/python3.7/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:543: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_qint16 = np.dtype([("qint16", np.int16, 1)])
/share/data/vision-greg2/users/xdu/anaconda3/envs/RSC/lib/python3.7/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:544: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_quint16 = np.dtype([("quint16", np.uint16, 1)])
/share/data/vision-greg2/users/xdu/anaconda3/envs/RSC/lib/python3.7/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:545: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_qint32 = np.dtype([("qint32", np.int32, 1)])
/share/data/vision-greg2/users/xdu/anaconda3/envs/RSC/lib/python3.7/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:550: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  np_resource = np.dtype([("resource", np.ubyte, 1)])
Target domain: art_painting
Dataset size: train 7137, val 806, test 2048
Step size: 16
New epoch - lr: 0.01
0/111 of epoch 1/20 class : 2.067 - acc class : 16.41 [bs:128]
30/111 of epoch 1/20 class : 1.045 - acc class : 73.44 [bs:128]
60/111 of epoch 1/20 class : 0.401 - acc class : 92.97 [bs:128]
90/111 of epoch 1/20 class : 0.597 - acc class : 79.69 [bs:128]
Accuracies on val: class : 90.69
Accuracies on test: class : 77.15
New epoch - lr: 0.01
0/111 of epoch 2/20 class : 0.539 - acc class : 79.69 [bs:128]
30/111 of epoch 2/20 class : 0.332 - acc class : 92.97 [bs:128]
60/111 of epoch 2/20 class : 0.475 - acc class : 82.03 [bs:128]
90/111 of epoch 2/20 class : 0.386 - acc class : 85.94 [bs:128]
Accuracies on val: class : 94.67
Accuracies on test: class : 76.76
New epoch - lr: 0.01
0/111 of epoch 3/20 class : 0.359 - acc class : 90.62 [bs:128]
30/111 of epoch 3/20 class : 0.202 - acc class : 92.97 [bs:128]
60/111 of epoch 3/20 class : 0.236 - acc class : 89.84 [bs:128]
90/111 of epoch 3/20 class : 0.256 - acc class : 92.19 [bs:128]
Accuracies on val: class : 93.42
Accuracies on test: class : 77.00
New epoch - lr: 0.01
0/111 of epoch 4/20 class : 0.174 - acc class : 96.09 [bs:128]
30/111 of epoch 4/20 class : 0.146 - acc class : 96.88 [bs:128]
60/111 of epoch 4/20 class : 0.176 - acc class : 93.75 [bs:128]
90/111 of epoch 4/20 class : 0.148 - acc class : 97.66 [bs:128]
Accuracies on val: class : 94.17
Accuracies on test: class : 76.51
New epoch - lr: 0.01
0/111 of epoch 5/20 class : 0.218 - acc class : 92.19 [bs:128]
30/111 of epoch 5/20 class : 0.142 - acc class : 96.88 [bs:128]
60/111 of epoch 5/20 class : 0.099 - acc class : 96.88 [bs:128]
90/111 of epoch 5/20 class : 0.200 - acc class : 92.19 [bs:128]
Accuracies on val: class : 94.79
Accuracies on test: class : 71.04
New epoch - lr: 0.01
0/111 of epoch 6/20 class : 0.076 - acc class : 97.66 [bs:128]
30/111 of epoch 6/20 class : 0.093 - acc class : 97.66 [bs:128]
60/111 of epoch 6/20 class : 0.153 - acc class : 94.53 [bs:128]
90/111 of epoch 6/20 class : 0.184 - acc class : 92.19 [bs:128]
Accuracies on val: class : 94.54
Accuracies on test: class : 76.71
New epoch - lr: 0.01
0/111 of epoch 7/20 class : 0.168 - acc class : 95.31 [bs:128]
30/111 of epoch 7/20 class : 0.077 - acc class : 96.88 [bs:128]
60/111 of epoch 7/20 class : 0.062 - acc class : 98.44 [bs:128]
90/111 of epoch 7/20 class : 0.082 - acc class : 96.88 [bs:128]
Accuracies on val: class : 94.04
Accuracies on test: class : 75.93
New epoch - lr: 0.01
0/111 of epoch 8/20 class : 0.026 - acc class : 100.00 [bs:128]
30/111 of epoch 8/20 class : 0.076 - acc class : 97.66 [bs:128]
60/111 of epoch 8/20 class : 0.050 - acc class : 99.22 [bs:128]
90/111 of epoch 8/20 class : 0.074 - acc class : 100.00 [bs:128]
Accuracies on val: class : 95.04
Accuracies on test: class : 78.12
New epoch - lr: 0.01
0/111 of epoch 9/20 class : 0.103 - acc class : 95.31 [bs:128]
30/111 of epoch 9/20 class : 0.072 - acc class : 96.88 [bs:128]
60/111 of epoch 9/20 class : 0.041 - acc class : 99.22 [bs:128]
90/111 of epoch 9/20 class : 0.237 - acc class : 93.75 [bs:128]
Accuracies on val: class : 94.67
Accuracies on test: class : 76.37
New epoch - lr: 0.01
0/111 of epoch 10/20 class : 0.066 - acc class : 97.66 [bs:128]
30/111 of epoch 10/20 class : 0.047 - acc class : 100.00 [bs:128]
60/111 of epoch 10/20 class : 0.035 - acc class : 99.22 [bs:128]
90/111 of epoch 10/20 class : 0.026 - acc class : 99.22 [bs:128]
Accuracies on val: class : 94.79
Accuracies on test: class : 76.03
New epoch - lr: 0.01
0/111 of epoch 11/20 class : 0.073 - acc class : 97.66 [bs:128]
30/111 of epoch 11/20 class : 0.085 - acc class : 98.44 [bs:128]
60/111 of epoch 11/20 class : 0.040 - acc class : 98.44 [bs:128]
90/111 of epoch 11/20 class : 0.039 - acc class : 100.00 [bs:128]
Accuracies on val: class : 95.91
Accuracies on test: class : 81.01
New epoch - lr: 0.01
0/111 of epoch 12/20 class : 0.017 - acc class : 100.00 [bs:128]
30/111 of epoch 12/20 class : 0.026 - acc class : 99.22 [bs:128]
60/111 of epoch 12/20 class : 0.028 - acc class : 100.00 [bs:128]
90/111 of epoch 12/20 class : 0.060 - acc class : 97.66 [bs:128]
Accuracies on val: class : 95.66
Accuracies on test: class : 78.91
New epoch - lr: 0.01
0/111 of epoch 13/20 class : 0.012 - acc class : 100.00 [bs:128]
30/111 of epoch 13/20 class : 0.023 - acc class : 99.22 [bs:128]
60/111 of epoch 13/20 class : 0.055 - acc class : 98.44 [bs:128]
90/111 of epoch 13/20 class : 0.068 - acc class : 96.88 [bs:128]
Accuracies on val: class : 94.29
Accuracies on test: class : 72.90
New epoch - lr: 0.01
0/111 of epoch 14/20 class : 0.151 - acc class : 95.31 [bs:128]
30/111 of epoch 14/20 class : 0.021 - acc class : 100.00 [bs:128]
60/111 of epoch 14/20 class : 0.033 - acc class : 99.22 [bs:128]
90/111 of epoch 14/20 class : 0.016 - acc class : 100.00 [bs:128]
Accuracies on val: class : 95.78
Accuracies on test: class : 77.44
New epoch - lr: 0.01
0/111 of epoch 15/20 class : 0.008 - acc class : 100.00 [bs:128]
30/111 of epoch 15/20 class : 0.011 - acc class : 100.00 [bs:128]
60/111 of epoch 15/20 class : 0.026 - acc class : 98.44 [bs:128]
90/111 of epoch 15/20 class : 0.015 - acc class : 100.00 [bs:128]
Accuracies on val: class : 94.04
Accuracies on test: class : 72.66
New epoch - lr: 0.01
0/111 of epoch 16/20 class : 0.059 - acc class : 98.44 [bs:128]
30/111 of epoch 16/20 class : 0.010 - acc class : 100.00 [bs:128]
60/111 of epoch 16/20 class : 0.008 - acc class : 100.00 [bs:128]
90/111 of epoch 16/20 class : 0.026 - acc class : 99.22 [bs:128]
Accuracies on val: class : 94.54
Accuracies on test: class : 76.07
New epoch - lr: 0.0001
0/111 of epoch 17/20 class : 0.048 - acc class : 98.44 [bs:128]
30/111 of epoch 17/20 class : 0.016 - acc class : 99.22 [bs:128]
60/111 of epoch 17/20 class : 0.029 - acc class : 99.22 [bs:128]
90/111 of epoch 17/20 class : 0.017 - acc class : 100.00 [bs:128]
Accuracies on val: class : 96.28
Accuracies on test: class : 80.47
New epoch - lr: 0.001
0/111 of epoch 18/20 class : 0.004 - acc class : 100.00 [bs:128]
30/111 of epoch 18/20 class : 0.009 - acc class : 100.00 [bs:128]
60/111 of epoch 18/20 class : 0.008 - acc class : 100.00 [bs:128]
90/111 of epoch 18/20 class : 0.042 - acc class : 98.44 [bs:128]
Accuracies on val: class : 95.91
Accuracies on test: class : 79.30
New epoch - lr: 0.001
0/111 of epoch 19/20 class : 0.045 - acc class : 98.44 [bs:128]
30/111 of epoch 19/20 class : 0.019 - acc class : 99.22 [bs:128]
60/111 of epoch 19/20 class : 0.017 - acc class : 100.00 [bs:128]
90/111 of epoch 19/20 class : 0.017 - acc class : 100.00 [bs:128]
Accuracies on val: class : 96.53
Accuracies on test: class : 80.08
New epoch - lr: 0.001
0/111 of epoch 20/20 class : 0.024 - acc class : 99.22 [bs:128]
30/111 of epoch 20/20 class : 0.015 - acc class : 100.00 [bs:128]
60/111 of epoch 20/20 class : 0.007 - acc class : 100.00 [bs:128]
90/111 of epoch 20/20 class : 0.021 - acc class : 100.00 [bs:128]
Accuracies on val: class : 96.15
Accuracies on test: class : 79.20
Best val 0.965261, corresponding test 0.800781 - best test: 0.810059, best epoch: 18
It took 445.759
/share/data/vision-greg2/users/xdu/anaconda3/envs/RSC/lib/python3.7/site-packages/tensorflow/python/framework/dtypes.py:516: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_qint8 = np.dtype([("qint8", np.int8, 1)])
/share/data/vision-greg2/users/xdu/anaconda3/envs/RSC/lib/python3.7/site-packages/tensorflow/python/framework/dtypes.py:517: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_quint8 = np.dtype([("quint8", np.uint8, 1)])
/share/data/vision-greg2/users/xdu/anaconda3/envs/RSC/lib/python3.7/site-packages/tensorflow/python/framework/dtypes.py:518: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_qint16 = np.dtype([("qint16", np.int16, 1)])
/share/data/vision-greg2/users/xdu/anaconda3/envs/RSC/lib/python3.7/site-packages/tensorflow/python/framework/dtypes.py:519: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_quint16 = np.dtype([("quint16", np.uint16, 1)])
/share/data/vision-greg2/users/xdu/anaconda3/envs/RSC/lib/python3.7/site-packages/tensorflow/python/framework/dtypes.py:520: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_qint32 = np.dtype([("qint32", np.int32, 1)])
/share/data/vision-greg2/users/xdu/anaconda3/envs/RSC/lib/python3.7/site-packages/tensorflow/python/framework/dtypes.py:525: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  np_resource = np.dtype([("resource", np.ubyte, 1)])
/share/data/vision-greg2/users/xdu/anaconda3/envs/RSC/lib/python3.7/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:541: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_qint8 = np.dtype([("qint8", np.int8, 1)])
/share/data/vision-greg2/users/xdu/anaconda3/envs/RSC/lib/python3.7/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:542: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_quint8 = np.dtype([("quint8", np.uint8, 1)])
/share/data/vision-greg2/users/xdu/anaconda3/envs/RSC/lib/python3.7/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:543: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_qint16 = np.dtype([("qint16", np.int16, 1)])
/share/data/vision-greg2/users/xdu/anaconda3/envs/RSC/lib/python3.7/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:544: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_quint16 = np.dtype([("quint16", np.uint16, 1)])
/share/data/vision-greg2/users/xdu/anaconda3/envs/RSC/lib/python3.7/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:545: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_qint32 = np.dtype([("qint32", np.int32, 1)])
/share/data/vision-greg2/users/xdu/anaconda3/envs/RSC/lib/python3.7/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:550: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  np_resource = np.dtype([("resource", np.ubyte, 1)])
Target domain: art_painting
Dataset size: train 7137, val 806, test 2048
Step size: 16
New epoch - lr: 0.01
0/111 of epoch 1/20 class : 2.067 - acc class : 16.41 [bs:128]
30/111 of epoch 1/20 class : 1.138 - acc class : 69.53 [bs:128]
60/111 of epoch 1/20 class : 0.384 - acc class : 90.62 [bs:128]
90/111 of epoch 1/20 class : 0.583 - acc class : 82.03 [bs:128]
Accuracies on val: class : 88.96
Accuracies on test: class : 76.66
New epoch - lr: 0.01
0/111 of epoch 2/20 class : 0.517 - acc class : 81.25 [bs:128]
30/111 of epoch 2/20 class : 0.559 - acc class : 73.44 [bs:128]
60/111 of epoch 2/20 class : 0.471 - acc class : 78.12 [bs:128]
90/111 of epoch 2/20 class : 0.339 - acc class : 86.72 [bs:128]
Accuracies on val: class : 93.67
Accuracies on test: class : 78.66
New epoch - lr: 0.01
0/111 of epoch 3/20 class : 0.454 - acc class : 82.03 [bs:128]
30/111 of epoch 3/20 class : 0.234 - acc class : 92.19 [bs:128]
60/111 of epoch 3/20 class : 0.289 - acc class : 89.84 [bs:128]
90/111 of epoch 3/20 class : 0.246 - acc class : 95.31 [bs:128]
Accuracies on val: class : 94.54
Accuracies on test: class : 77.25
New epoch - lr: 0.01
0/111 of epoch 4/20 class : 0.195 - acc class : 94.53 [bs:128]
30/111 of epoch 4/20 class : 0.195 - acc class : 91.41 [bs:128]
60/111 of epoch 4/20 class : 0.268 - acc class : 92.19 [bs:128]
90/111 of epoch 4/20 class : 0.193 - acc class : 92.19 [bs:128]
Accuracies on val: class : 94.04
Accuracies on test: class : 77.20
New epoch - lr: 0.01
0/111 of epoch 5/20 class : 0.257 - acc class : 91.41 [bs:128]
30/111 of epoch 5/20 class : 0.184 - acc class : 94.53 [bs:128]
60/111 of epoch 5/20 class : 0.135 - acc class : 98.44 [bs:128]
90/111 of epoch 5/20 class : 0.144 - acc class : 96.88 [bs:128]
Accuracies on val: class : 95.41
Accuracies on test: class : 77.05
New epoch - lr: 0.01
0/111 of epoch 6/20 class : 0.075 - acc class : 98.44 [bs:128]
30/111 of epoch 6/20 class : 0.104 - acc class : 96.88 [bs:128]
60/111 of epoch 6/20 class : 0.103 - acc class : 96.09 [bs:128]
90/111 of epoch 6/20 class : 0.144 - acc class : 95.31 [bs:128]
Accuracies on val: class : 94.91
Accuracies on test: class : 73.63
New epoch - lr: 0.01
0/111 of epoch 7/20 class : 0.182 - acc class : 92.19 [bs:128]
30/111 of epoch 7/20 class : 0.087 - acc class : 96.09 [bs:128]
60/111 of epoch 7/20 class : 0.076 - acc class : 99.22 [bs:128]
90/111 of epoch 7/20 class : 0.087 - acc class : 97.66 [bs:128]
Accuracies on val: class : 94.91
Accuracies on test: class : 81.40
New epoch - lr: 0.01
0/111 of epoch 8/20 class : 0.042 - acc class : 97.66 [bs:128]
30/111 of epoch 8/20 class : 0.136 - acc class : 96.88 [bs:128]
60/111 of epoch 8/20 class : 0.063 - acc class : 97.66 [bs:128]
90/111 of epoch 8/20 class : 0.135 - acc class : 95.31 [bs:128]
Accuracies on val: class : 95.04
Accuracies on test: class : 79.10
New epoch - lr: 0.01
0/111 of epoch 9/20 class : 0.025 - acc class : 99.22 [bs:128]
30/111 of epoch 9/20 class : 0.059 - acc class : 97.66 [bs:128]
60/111 of epoch 9/20 class : 0.045 - acc class : 99.22 [bs:128]
90/111 of epoch 9/20 class : 0.061 - acc class : 98.44 [bs:128]
Accuracies on val: class : 95.78
Accuracies on test: class : 76.07
New epoch - lr: 0.01
0/111 of epoch 10/20 class : 0.028 - acc class : 100.00 [bs:128]
30/111 of epoch 10/20 class : 0.032 - acc class : 99.22 [bs:128]
60/111 of epoch 10/20 class : 0.029 - acc class : 100.00 [bs:128]
90/111 of epoch 10/20 class : 0.025 - acc class : 100.00 [bs:128]
Accuracies on val: class : 94.42
Accuracies on test: class : 78.03
New epoch - lr: 0.01
0/111 of epoch 11/20 class : 0.083 - acc class : 97.66 [bs:128]
30/111 of epoch 11/20 class : 0.120 - acc class : 97.66 [bs:128]
60/111 of epoch 11/20 class : 0.028 - acc class : 100.00 [bs:128]
90/111 of epoch 11/20 class : 0.068 - acc class : 98.44 [bs:128]
Accuracies on val: class : 94.91
Accuracies on test: class : 76.86
New epoch - lr: 0.01
0/111 of epoch 12/20 class : 0.024 - acc class : 100.00 [bs:128]
30/111 of epoch 12/20 class : 0.015 - acc class : 100.00 [bs:128]
60/111 of epoch 12/20 class : 0.105 - acc class : 96.09 [bs:128]
90/111 of epoch 12/20 class : 0.211 - acc class : 95.31 [bs:128]
Accuracies on val: class : 93.42
Accuracies on test: class : 75.15
New epoch - lr: 0.01
0/111 of epoch 13/20 class : 0.091 - acc class : 97.66 [bs:128]
30/111 of epoch 13/20 class : 0.068 - acc class : 99.22 [bs:128]
60/111 of epoch 13/20 class : 0.078 - acc class : 98.44 [bs:128]
90/111 of epoch 13/20 class : 0.055 - acc class : 98.44 [bs:128]
Accuracies on val: class : 96.03
Accuracies on test: class : 78.32
New epoch - lr: 0.01
0/111 of epoch 14/20 class : 0.091 - acc class : 97.66 [bs:128]
30/111 of epoch 14/20 class : 0.026 - acc class : 100.00 [bs:128]
60/111 of epoch 14/20 class : 0.024 - acc class : 98.44 [bs:128]
90/111 of epoch 14/20 class : 0.007 - acc class : 100.00 [bs:128]
Accuracies on val: class : 95.91
Accuracies on test: class : 81.15
New epoch - lr: 0.01
0/111 of epoch 15/20 class : 0.030 - acc class : 99.22 [bs:128]
30/111 of epoch 15/20 class : 0.029 - acc class : 99.22 [bs:128]
60/111 of epoch 15/20 class : 0.013 - acc class : 100.00 [bs:128]
90/111 of epoch 15/20 class : 0.021 - acc class : 99.22 [bs:128]
Accuracies on val: class : 94.42
Accuracies on test: class : 78.08
New epoch - lr: 0.01
0/111 of epoch 16/20 class : 0.026 - acc class : 99.22 [bs:128]
30/111 of epoch 16/20 class : 0.003 - acc class : 100.00 [bs:128]
60/111 of epoch 16/20 class : 0.025 - acc class : 99.22 [bs:128]
90/111 of epoch 16/20 class : 0.021 - acc class : 100.00 [bs:128]
Accuracies on val: class : 94.42
Accuracies on test: class : 75.59
New epoch - lr: 0.0001
0/111 of epoch 17/20 class : 0.084 - acc class : 98.44 [bs:128]
30/111 of epoch 17/20 class : 0.031 - acc class : 99.22 [bs:128]
60/111 of epoch 17/20 class : 0.011 - acc class : 100.00 [bs:128]
90/111 of epoch 17/20 class : 0.008 - acc class : 100.00 [bs:128]
Accuracies on val: class : 96.65
Accuracies on test: class : 79.10
New epoch - lr: 0.001
0/111 of epoch 18/20 class : 0.007 - acc class : 100.00 [bs:128]
30/111 of epoch 18/20 class : 0.011 - acc class : 100.00 [bs:128]
60/111 of epoch 18/20 class : 0.008 - acc class : 100.00 [bs:128]
90/111 of epoch 18/20 class : 0.031 - acc class : 98.44 [bs:128]
Accuracies on val: class : 96.28
Accuracies on test: class : 78.12
New epoch - lr: 0.001
0/111 of epoch 19/20 class : 0.036 - acc class : 98.44 [bs:128]
30/111 of epoch 19/20 class : 0.009 - acc class : 100.00 [bs:128]
60/111 of epoch 19/20 class : 0.027 - acc class : 97.66 [bs:128]
90/111 of epoch 19/20 class : 0.008 - acc class : 100.00 [bs:128]
Accuracies on val: class : 96.65
Accuracies on test: class : 80.66
New epoch - lr: 0.001
0/111 of epoch 20/20 class : 0.016 - acc class : 100.00 [bs:128]
30/111 of epoch 20/20 class : 0.008 - acc class : 100.00 [bs:128]
60/111 of epoch 20/20 class : 0.021 - acc class : 100.00 [bs:128]
90/111 of epoch 20/20 class : 0.014 - acc class : 100.00 [bs:128]
Accuracies on val: class : 96.15
Accuracies on test: class : 80.42
Best val 0.966501, corresponding test 0.806641 - best test: 0.813965, best epoch: 18
It took 436.725
/share/data/vision-greg2/users/xdu/anaconda3/envs/RSC/lib/python3.7/site-packages/tensorflow/python/framework/dtypes.py:516: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_qint8 = np.dtype([("qint8", np.int8, 1)])
/share/data/vision-greg2/users/xdu/anaconda3/envs/RSC/lib/python3.7/site-packages/tensorflow/python/framework/dtypes.py:517: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_quint8 = np.dtype([("quint8", np.uint8, 1)])
/share/data/vision-greg2/users/xdu/anaconda3/envs/RSC/lib/python3.7/site-packages/tensorflow/python/framework/dtypes.py:518: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_qint16 = np.dtype([("qint16", np.int16, 1)])
/share/data/vision-greg2/users/xdu/anaconda3/envs/RSC/lib/python3.7/site-packages/tensorflow/python/framework/dtypes.py:519: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_quint16 = np.dtype([("quint16", np.uint16, 1)])
/share/data/vision-greg2/users/xdu/anaconda3/envs/RSC/lib/python3.7/site-packages/tensorflow/python/framework/dtypes.py:520: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_qint32 = np.dtype([("qint32", np.int32, 1)])
/share/data/vision-greg2/users/xdu/anaconda3/envs/RSC/lib/python3.7/site-packages/tensorflow/python/framework/dtypes.py:525: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  np_resource = np.dtype([("resource", np.ubyte, 1)])
/share/data/vision-greg2/users/xdu/anaconda3/envs/RSC/lib/python3.7/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:541: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_qint8 = np.dtype([("qint8", np.int8, 1)])
/share/data/vision-greg2/users/xdu/anaconda3/envs/RSC/lib/python3.7/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:542: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_quint8 = np.dtype([("quint8", np.uint8, 1)])
/share/data/vision-greg2/users/xdu/anaconda3/envs/RSC/lib/python3.7/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:543: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_qint16 = np.dtype([("qint16", np.int16, 1)])
/share/data/vision-greg2/users/xdu/anaconda3/envs/RSC/lib/python3.7/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:544: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_quint16 = np.dtype([("quint16", np.uint16, 1)])
/share/data/vision-greg2/users/xdu/anaconda3/envs/RSC/lib/python3.7/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:545: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_qint32 = np.dtype([("qint32", np.int32, 1)])
/share/data/vision-greg2/users/xdu/anaconda3/envs/RSC/lib/python3.7/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:550: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  np_resource = np.dtype([("resource", np.ubyte, 1)])
Target domain: art_painting
Dataset size: train 7137, val 806, test 2048
Step size: 16
New epoch - lr: 0.01
0/111 of epoch 1/20 class : 3.166 - acc class : 0.00 [bs:128]
30/111 of epoch 1/20 class : 1.068 - acc class : 68.75 [bs:128]
60/111 of epoch 1/20 class : 0.711 - acc class : 67.19 [bs:128]
90/111 of epoch 1/20 class : 0.700 - acc class : 66.41 [bs:128]
Accuracies on val: class : 90.57
Accuracies on test: class : 75.15
New epoch - lr: 0.01
0/111 of epoch 2/20 class : 0.543 - acc class : 73.44 [bs:128]
30/111 of epoch 2/20 class : 0.483 - acc class : 72.66 [bs:128]
60/111 of epoch 2/20 class : 0.411 - acc class : 82.81 [bs:128]
90/111 of epoch 2/20 class : 0.285 - acc class : 88.28 [bs:128]
Accuracies on val: class : 93.18
Accuracies on test: class : 77.78
New epoch - lr: 0.01
0/111 of epoch 3/20 class : 0.448 - acc class : 89.84 [bs:128]
30/111 of epoch 3/20 class : 0.190 - acc class : 94.53 [bs:128]
60/111 of epoch 3/20 class : 0.238 - acc class : 92.19 [bs:128]
90/111 of epoch 3/20 class : 0.228 - acc class : 93.75 [bs:128]
Accuracies on val: class : 94.54
Accuracies on test: class : 81.69
New epoch - lr: 0.01
0/111 of epoch 4/20 class : 0.183 - acc class : 92.97 [bs:128]
30/111 of epoch 4/20 class : 0.145 - acc class : 96.09 [bs:128]
60/111 of epoch 4/20 class : 0.201 - acc class : 93.75 [bs:128]
90/111 of epoch 4/20 class : 0.166 - acc class : 92.97 [bs:128]
Accuracies on val: class : 94.67
Accuracies on test: class : 74.71
New epoch - lr: 0.01
0/111 of epoch 5/20 class : 0.236 - acc class : 89.84 [bs:128]
30/111 of epoch 5/20 class : 0.126 - acc class : 98.44 [bs:128]
60/111 of epoch 5/20 class : 0.161 - acc class : 92.97 [bs:128]
90/111 of epoch 5/20 class : 0.124 - acc class : 97.66 [bs:128]
Accuracies on val: class : 94.67
Accuracies on test: class : 76.71
New epoch - lr: 0.01
0/111 of epoch 6/20 class : 0.187 - acc class : 93.75 [bs:128]
30/111 of epoch 6/20 class : 0.066 - acc class : 99.22 [bs:128]
60/111 of epoch 6/20 class : 0.153 - acc class : 95.31 [bs:128]
90/111 of epoch 6/20 class : 0.129 - acc class : 93.75 [bs:128]
Accuracies on val: class : 94.67
Accuracies on test: class : 69.04
New epoch - lr: 0.01
0/111 of epoch 7/20 class : 0.107 - acc class : 99.22 [bs:128]
30/111 of epoch 7/20 class : 0.083 - acc class : 97.66 [bs:128]
60/111 of epoch 7/20 class : 0.054 - acc class : 98.44 [bs:128]
90/111 of epoch 7/20 class : 0.099 - acc class : 96.88 [bs:128]
Accuracies on val: class : 94.91
Accuracies on test: class : 78.61
New epoch - lr: 0.01
0/111 of epoch 8/20 class : 0.036 - acc class : 99.22 [bs:128]
30/111 of epoch 8/20 class : 0.083 - acc class : 97.66 [bs:128]
60/111 of epoch 8/20 class : 0.070 - acc class : 97.66 [bs:128]
90/111 of epoch 8/20 class : 0.137 - acc class : 94.53 [bs:128]
Accuracies on val: class : 95.04
Accuracies on test: class : 79.44
New epoch - lr: 0.01
0/111 of epoch 9/20 class : 0.047 - acc class : 98.44 [bs:128]
30/111 of epoch 9/20 class : 0.070 - acc class : 98.44 [bs:128]
60/111 of epoch 9/20 class : 0.018 - acc class : 100.00 [bs:128]
90/111 of epoch 9/20 class : 0.104 - acc class : 94.53 [bs:128]
Accuracies on val: class : 93.55
Accuracies on test: class : 74.56
New epoch - lr: 0.01
0/111 of epoch 10/20 class : 0.036 - acc class : 99.22 [bs:128]
30/111 of epoch 10/20 class : 0.054 - acc class : 97.66 [bs:128]
60/111 of epoch 10/20 class : 0.025 - acc class : 99.22 [bs:128]
90/111 of epoch 10/20 class : 0.036 - acc class : 98.44 [bs:128]
Accuracies on val: class : 93.42
Accuracies on test: class : 77.39
New epoch - lr: 0.01
0/111 of epoch 11/20 class : 0.189 - acc class : 89.06 [bs:128]
30/111 of epoch 11/20 class : 0.093 - acc class : 97.66 [bs:128]
60/111 of epoch 11/20 class : 0.022 - acc class : 100.00 [bs:128]
90/111 of epoch 11/20 class : 0.050 - acc class : 98.44 [bs:128]
Accuracies on val: class : 95.16
Accuracies on test: class : 81.54
New epoch - lr: 0.01
0/111 of epoch 12/20 class : 0.023 - acc class : 100.00 [bs:128]
30/111 of epoch 12/20 class : 0.032 - acc class : 98.44 [bs:128]
60/111 of epoch 12/20 class : 0.069 - acc class : 98.44 [bs:128]
90/111 of epoch 12/20 class : 0.095 - acc class : 94.53 [bs:128]
Accuracies on val: class : 94.79
Accuracies on test: class : 77.00
New epoch - lr: 0.01
0/111 of epoch 13/20 class : 0.008 - acc class : 100.00 [bs:128]
30/111 of epoch 13/20 class : 0.025 - acc class : 100.00 [bs:128]
60/111 of epoch 13/20 class : 0.034 - acc class : 100.00 [bs:128]
90/111 of epoch 13/20 class : 0.041 - acc class : 98.44 [bs:128]
Accuracies on val: class : 95.41
Accuracies on test: class : 79.59
New epoch - lr: 0.01
0/111 of epoch 14/20 class : 0.040 - acc class : 97.66 [bs:128]
30/111 of epoch 14/20 class : 0.020 - acc class : 100.00 [bs:128]
60/111 of epoch 14/20 class : 0.029 - acc class : 99.22 [bs:128]
90/111 of epoch 14/20 class : 0.005 - acc class : 100.00 [bs:128]
Accuracies on val: class : 94.42
Accuracies on test: class : 75.63
New epoch - lr: 0.01
0/111 of epoch 15/20 class : 0.017 - acc class : 100.00 [bs:128]
30/111 of epoch 15/20 class : 0.049 - acc class : 99.22 [bs:128]
60/111 of epoch 15/20 class : 0.021 - acc class : 100.00 [bs:128]
90/111 of epoch 15/20 class : 0.025 - acc class : 100.00 [bs:128]
Accuracies on val: class : 91.81
Accuracies on test: class : 73.14
New epoch - lr: 0.01
0/111 of epoch 16/20 class : 0.020 - acc class : 98.44 [bs:128]
30/111 of epoch 16/20 class : 0.008 - acc class : 100.00 [bs:128]
60/111 of epoch 16/20 class : 0.021 - acc class : 100.00 [bs:128]
90/111 of epoch 16/20 class : 0.030 - acc class : 99.22 [bs:128]
Accuracies on val: class : 94.17
Accuracies on test: class : 77.44
New epoch - lr: 0.0001
0/111 of epoch 17/20 class : 0.130 - acc class : 95.31 [bs:128]
30/111 of epoch 17/20 class : 0.008 - acc class : 100.00 [bs:128]
60/111 of epoch 17/20 class : 0.009 - acc class : 100.00 [bs:128]
90/111 of epoch 17/20 class : 0.023 - acc class : 99.22 [bs:128]
Accuracies on val: class : 95.53
Accuracies on test: class : 79.25
New epoch - lr: 0.001
0/111 of epoch 18/20 class : 0.012 - acc class : 100.00 [bs:128]
30/111 of epoch 18/20 class : 0.027 - acc class : 99.22 [bs:128]
60/111 of epoch 18/20 class : 0.026 - acc class : 100.00 [bs:128]
90/111 of epoch 18/20 class : 0.102 - acc class : 96.88 [bs:128]
Accuracies on val: class : 95.66
Accuracies on test: class : 79.10
New epoch - lr: 0.001
0/111 of epoch 19/20 class : 0.035 - acc class : 99.22 [bs:128]
30/111 of epoch 19/20 class : 0.014 - acc class : 100.00 [bs:128]
60/111 of epoch 19/20 class : 0.035 - acc class : 99.22 [bs:128]
90/111 of epoch 19/20 class : 0.010 - acc class : 100.00 [bs:128]
Accuracies on val: class : 95.78
Accuracies on test: class : 80.96
New epoch - lr: 0.001
0/111 of epoch 20/20 class : 0.020 - acc class : 99.22 [bs:128]
30/111 of epoch 20/20 class : 0.006 - acc class : 100.00 [bs:128]
60/111 of epoch 20/20 class : 0.013 - acc class : 100.00 [bs:128]
90/111 of epoch 20/20 class : 0.022 - acc class : 99.22 [bs:128]
Accuracies on val: class : 95.29
Accuracies on test: class : 80.62
Best val 0.957816, corresponding test 0.80957 - best test: 0.816895, best epoch: 18
It took 434.562
/share/data/vision-greg2/users/xdu/anaconda3/envs/RSC/lib/python3.7/site-packages/tensorflow/python/framework/dtypes.py:516: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_qint8 = np.dtype([("qint8", np.int8, 1)])
/share/data/vision-greg2/users/xdu/anaconda3/envs/RSC/lib/python3.7/site-packages/tensorflow/python/framework/dtypes.py:517: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_quint8 = np.dtype([("quint8", np.uint8, 1)])
/share/data/vision-greg2/users/xdu/anaconda3/envs/RSC/lib/python3.7/site-packages/tensorflow/python/framework/dtypes.py:518: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_qint16 = np.dtype([("qint16", np.int16, 1)])
/share/data/vision-greg2/users/xdu/anaconda3/envs/RSC/lib/python3.7/site-packages/tensorflow/python/framework/dtypes.py:519: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_quint16 = np.dtype([("quint16", np.uint16, 1)])
/share/data/vision-greg2/users/xdu/anaconda3/envs/RSC/lib/python3.7/site-packages/tensorflow/python/framework/dtypes.py:520: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_qint32 = np.dtype([("qint32", np.int32, 1)])
/share/data/vision-greg2/users/xdu/anaconda3/envs/RSC/lib/python3.7/site-packages/tensorflow/python/framework/dtypes.py:525: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  np_resource = np.dtype([("resource", np.ubyte, 1)])
/share/data/vision-greg2/users/xdu/anaconda3/envs/RSC/lib/python3.7/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:541: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_qint8 = np.dtype([("qint8", np.int8, 1)])
/share/data/vision-greg2/users/xdu/anaconda3/envs/RSC/lib/python3.7/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:542: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_quint8 = np.dtype([("quint8", np.uint8, 1)])
/share/data/vision-greg2/users/xdu/anaconda3/envs/RSC/lib/python3.7/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:543: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_qint16 = np.dtype([("qint16", np.int16, 1)])
/share/data/vision-greg2/users/xdu/anaconda3/envs/RSC/lib/python3.7/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:544: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_quint16 = np.dtype([("quint16", np.uint16, 1)])
/share/data/vision-greg2/users/xdu/anaconda3/envs/RSC/lib/python3.7/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:545: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_qint32 = np.dtype([("qint32", np.int32, 1)])
/share/data/vision-greg2/users/xdu/anaconda3/envs/RSC/lib/python3.7/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:550: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  np_resource = np.dtype([("resource", np.ubyte, 1)])
Target domain: art_painting
Dataset size: train 7137, val 806, test 2048
Step size: 16
New epoch - lr: 0.01
0/111 of epoch 1/20 class : 3.166 - acc class : 0.00 [bs:128]
30/111 of epoch 1/20 class : 1.078 - acc class : 71.09 [bs:128]
60/111 of epoch 1/20 class : 0.716 - acc class : 67.19 [bs:128]
90/111 of epoch 1/20 class : 0.669 - acc class : 67.97 [bs:128]
Accuracies on val: class : 83.87
Accuracies on test: class : 75.20
New epoch - lr: 0.01
0/111 of epoch 2/20 class : 0.556 - acc class : 78.12 [bs:128]
30/111 of epoch 2/20 class : 0.336 - acc class : 90.62 [bs:128]
60/111 of epoch 2/20 class : 0.473 - acc class : 81.25 [bs:128]
90/111 of epoch 2/20 class : 0.338 - acc class : 84.38 [bs:128]
Accuracies on val: class : 94.17
Accuracies on test: class : 77.05
New epoch - lr: 0.01
0/111 of epoch 3/20 class : 0.410 - acc class : 89.84 [bs:128]
30/111 of epoch 3/20 class : 0.220 - acc class : 92.19 [bs:128]
60/111 of epoch 3/20 class : 0.311 - acc class : 86.72 [bs:128]
90/111 of epoch 3/20 class : 0.217 - acc class : 94.53 [bs:128]
Accuracies on val: class : 93.80
Accuracies on test: class : 72.95
New epoch - lr: 0.01
0/111 of epoch 4/20 class : 0.229 - acc class : 90.62 [bs:128]
30/111 of epoch 4/20 class : 0.204 - acc class : 91.41 [bs:128]
60/111 of epoch 4/20 class : 0.296 - acc class : 90.62 [bs:128]
90/111 of epoch 4/20 class : 0.157 - acc class : 96.09 [bs:128]
Accuracies on val: class : 93.55
Accuracies on test: class : 75.34
New epoch - lr: 0.01
0/111 of epoch 5/20 class : 0.211 - acc class : 94.53 [bs:128]
30/111 of epoch 5/20 class : 0.104 - acc class : 100.00 [bs:128]
60/111 of epoch 5/20 class : 0.140 - acc class : 96.09 [bs:128]
90/111 of epoch 5/20 class : 0.145 - acc class : 94.53 [bs:128]
Accuracies on val: class : 95.53
Accuracies on test: class : 75.44
New epoch - lr: 0.01
0/111 of epoch 6/20 class : 0.178 - acc class : 93.75 [bs:128]
30/111 of epoch 6/20 class : 0.181 - acc class : 92.19 [bs:128]
60/111 of epoch 6/20 class : 0.164 - acc class : 94.53 [bs:128]
90/111 of epoch 6/20 class : 0.225 - acc class : 92.19 [bs:128]
Accuracies on val: class : 94.17
Accuracies on test: class : 75.10
New epoch - lr: 0.01
0/111 of epoch 7/20 class : 0.336 - acc class : 79.69 [bs:128]
30/111 of epoch 7/20 class : 0.077 - acc class : 97.66 [bs:128]
60/111 of epoch 7/20 class : 0.084 - acc class : 98.44 [bs:128]
90/111 of epoch 7/20 class : 0.121 - acc class : 96.09 [bs:128]
Accuracies on val: class : 95.29
Accuracies on test: class : 75.73
New epoch - lr: 0.01
0/111 of epoch 8/20 class : 0.044 - acc class : 99.22 [bs:128]
30/111 of epoch 8/20 class : 0.158 - acc class : 95.31 [bs:128]
60/111 of epoch 8/20 class : 0.060 - acc class : 96.88 [bs:128]
90/111 of epoch 8/20 class : 0.073 - acc class : 98.44 [bs:128]
Accuracies on val: class : 94.54
Accuracies on test: class : 80.76
New epoch - lr: 0.01
0/111 of epoch 9/20 class : 0.073 - acc class : 95.31 [bs:128]
30/111 of epoch 9/20 class : 0.105 - acc class : 96.88 [bs:128]
60/111 of epoch 9/20 class : 0.041 - acc class : 100.00 [bs:128]
90/111 of epoch 9/20 class : 0.065 - acc class : 98.44 [bs:128]
Accuracies on val: class : 95.41
Accuracies on test: class : 73.00
New epoch - lr: 0.01
0/111 of epoch 10/20 class : 0.024 - acc class : 100.00 [bs:128]
30/111 of epoch 10/20 class : 0.063 - acc class : 97.66 [bs:128]
60/111 of epoch 10/20 class : 0.043 - acc class : 99.22 [bs:128]
90/111 of epoch 10/20 class : 0.029 - acc class : 99.22 [bs:128]
Accuracies on val: class : 93.18
Accuracies on test: class : 79.44
New epoch - lr: 0.01
0/111 of epoch 11/20 class : 0.071 - acc class : 97.66 [bs:128]
30/111 of epoch 11/20 class : 0.082 - acc class : 98.44 [bs:128]
60/111 of epoch 11/20 class : 0.031 - acc class : 99.22 [bs:128]
90/111 of epoch 11/20 class : 0.057 - acc class : 97.66 [bs:128]
Accuracies on val: class : 95.41
Accuracies on test: class : 77.54
New epoch - lr: 0.01
0/111 of epoch 12/20 class : 0.014 - acc class : 100.00 [bs:128]
30/111 of epoch 12/20 class : 0.023 - acc class : 99.22 [bs:128]
60/111 of epoch 12/20 class : 0.051 - acc class : 97.66 [bs:128]
90/111 of epoch 12/20 class : 0.068 - acc class : 98.44 [bs:128]
Accuracies on val: class : 95.41
Accuracies on test: class : 78.27
New epoch - lr: 0.01
0/111 of epoch 13/20 class : 0.006 - acc class : 100.00 [bs:128]
30/111 of epoch 13/20 class : 0.022 - acc class : 99.22 [bs:128]
60/111 of epoch 13/20 class : 0.036 - acc class : 98.44 [bs:128]
90/111 of epoch 13/20 class : 0.031 - acc class : 99.22 [bs:128]
Accuracies on val: class : 95.66
Accuracies on test: class : 76.03
New epoch - lr: 0.01
0/111 of epoch 14/20 class : 0.033 - acc class : 99.22 [bs:128]
30/111 of epoch 14/20 class : 0.015 - acc class : 100.00 [bs:128]
60/111 of epoch 14/20 class : 0.016 - acc class : 100.00 [bs:128]
90/111 of epoch 14/20 class : 0.014 - acc class : 99.22 [bs:128]
Accuracies on val: class : 95.16
Accuracies on test: class : 82.52
New epoch - lr: 0.01
0/111 of epoch 15/20 class : 0.028 - acc class : 99.22 [bs:128]
30/111 of epoch 15/20 class : 0.044 - acc class : 99.22 [bs:128]
60/111 of epoch 15/20 class : 0.017 - acc class : 99.22 [bs:128]
90/111 of epoch 15/20 class : 0.015 - acc class : 100.00 [bs:128]
Accuracies on val: class : 95.29
Accuracies on test: class : 79.30
New epoch - lr: 0.01
0/111 of epoch 16/20 class : 0.008 - acc class : 100.00 [bs:128]
30/111 of epoch 16/20 class : 0.004 - acc class : 100.00 [bs:128]
60/111 of epoch 16/20 class : 0.011 - acc class : 100.00 [bs:128]
90/111 of epoch 16/20 class : 0.013 - acc class : 100.00 [bs:128]
Accuracies on val: class : 94.04
Accuracies on test: class : 78.17
New epoch - lr: 0.0001
0/111 of epoch 17/20 class : 0.034 - acc class : 98.44 [bs:128]
30/111 of epoch 17/20 class : 0.018 - acc class : 100.00 [bs:128]
60/111 of epoch 17/20 class : 0.010 - acc class : 100.00 [bs:128]
90/111 of epoch 17/20 class : 0.109 - acc class : 95.31 [bs:128]
Accuracies on val: class : 96.77
Accuracies on test: class : 80.08
New epoch - lr: 0.001
0/111 of epoch 18/20 class : 0.034 - acc class : 99.22 [bs:128]
30/111 of epoch 18/20 class : 0.030 - acc class : 99.22 [bs:128]
60/111 of epoch 18/20 class : 0.020 - acc class : 99.22 [bs:128]
90/111 of epoch 18/20 class : 0.014 - acc class : 100.00 [bs:128]
Accuracies on val: class : 96.53
Accuracies on test: class : 79.79
New epoch - lr: 0.001
0/111 of epoch 19/20 class : 0.058 - acc class : 99.22 [bs:128]
30/111 of epoch 19/20 class : 0.019 - acc class : 100.00 [bs:128]
60/111 of epoch 19/20 class : 0.150 - acc class : 99.22 [bs:128]
90/111 of epoch 19/20 class : 0.008 - acc class : 100.00 [bs:128]
Accuracies on val: class : 96.53
Accuracies on test: class : 81.84
New epoch - lr: 0.001
0/111 of epoch 20/20 class : 0.007 - acc class : 100.00 [bs:128]
30/111 of epoch 20/20 class : 0.006 - acc class : 100.00 [bs:128]
60/111 of epoch 20/20 class : 0.007 - acc class : 100.00 [bs:128]
90/111 of epoch 20/20 class : 0.044 - acc class : 98.44 [bs:128]
Accuracies on val: class : 96.28
Accuracies on test: class : 81.84
Best val 0.967742, corresponding test 0.800781 - best test: 0.825195, best epoch: 16
It took 441.375
/share/data/vision-greg2/users/xdu/anaconda3/envs/RSC/lib/python3.7/site-packages/tensorflow/python/framework/dtypes.py:516: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_qint8 = np.dtype([("qint8", np.int8, 1)])
/share/data/vision-greg2/users/xdu/anaconda3/envs/RSC/lib/python3.7/site-packages/tensorflow/python/framework/dtypes.py:517: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_quint8 = np.dtype([("quint8", np.uint8, 1)])
/share/data/vision-greg2/users/xdu/anaconda3/envs/RSC/lib/python3.7/site-packages/tensorflow/python/framework/dtypes.py:518: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_qint16 = np.dtype([("qint16", np.int16, 1)])
/share/data/vision-greg2/users/xdu/anaconda3/envs/RSC/lib/python3.7/site-packages/tensorflow/python/framework/dtypes.py:519: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_quint16 = np.dtype([("quint16", np.uint16, 1)])
/share/data/vision-greg2/users/xdu/anaconda3/envs/RSC/lib/python3.7/site-packages/tensorflow/python/framework/dtypes.py:520: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_qint32 = np.dtype([("qint32", np.int32, 1)])
/share/data/vision-greg2/users/xdu/anaconda3/envs/RSC/lib/python3.7/site-packages/tensorflow/python/framework/dtypes.py:525: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  np_resource = np.dtype([("resource", np.ubyte, 1)])
/share/data/vision-greg2/users/xdu/anaconda3/envs/RSC/lib/python3.7/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:541: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_qint8 = np.dtype([("qint8", np.int8, 1)])
/share/data/vision-greg2/users/xdu/anaconda3/envs/RSC/lib/python3.7/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:542: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_quint8 = np.dtype([("quint8", np.uint8, 1)])
/share/data/vision-greg2/users/xdu/anaconda3/envs/RSC/lib/python3.7/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:543: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_qint16 = np.dtype([("qint16", np.int16, 1)])
/share/data/vision-greg2/users/xdu/anaconda3/envs/RSC/lib/python3.7/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:544: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_quint16 = np.dtype([("quint16", np.uint16, 1)])
/share/data/vision-greg2/users/xdu/anaconda3/envs/RSC/lib/python3.7/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:545: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_qint32 = np.dtype([("qint32", np.int32, 1)])
/share/data/vision-greg2/users/xdu/anaconda3/envs/RSC/lib/python3.7/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:550: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  np_resource = np.dtype([("resource", np.ubyte, 1)])
Target domain: art_painting
Dataset size: train 7137, val 806, test 2048
Step size: 16
New epoch - lr: 0.01
0/111 of epoch 1/20 class : 3.166 - acc class : 0.00 [bs:128]
30/111 of epoch 1/20 class : 1.781 - acc class : 45.31 [bs:128]
60/111 of epoch 1/20 class : 0.394 - acc class : 92.19 [bs:128]
90/111 of epoch 1/20 class : 0.772 - acc class : 64.06 [bs:128]
Accuracies on val: class : 90.32
Accuracies on test: class : 74.07
New epoch - lr: 0.01
0/111 of epoch 2/20 class : 0.455 - acc class : 85.94 [bs:128]
30/111 of epoch 2/20 class : 0.358 - acc class : 89.84 [bs:128]
60/111 of epoch 2/20 class : 0.410 - acc class : 88.28 [bs:128]
90/111 of epoch 2/20 class : 0.266 - acc class : 93.75 [bs:128]
Accuracies on val: class : 93.80
Accuracies on test: class : 77.83
New epoch - lr: 0.01
0/111 of epoch 3/20 class : 0.385 - acc class : 88.28 [bs:128]
30/111 of epoch 3/20 class : 0.217 - acc class : 95.31 [bs:128]
60/111 of epoch 3/20 class : 0.244 - acc class : 92.19 [bs:128]
90/111 of epoch 3/20 class : 0.297 - acc class : 92.19 [bs:128]
Accuracies on val: class : 93.55
Accuracies on test: class : 71.19
New epoch - lr: 0.01
0/111 of epoch 4/20 class : 0.219 - acc class : 92.97 [bs:128]
30/111 of epoch 4/20 class : 0.151 - acc class : 95.31 [bs:128]
60/111 of epoch 4/20 class : 0.211 - acc class : 94.53 [bs:128]
90/111 of epoch 4/20 class : 0.141 - acc class : 96.09 [bs:128]
Accuracies on val: class : 92.18
Accuracies on test: class : 74.12
New epoch - lr: 0.01
0/111 of epoch 5/20 class : 0.210 - acc class : 93.75 [bs:128]
30/111 of epoch 5/20 class : 0.217 - acc class : 91.41 [bs:128]
60/111 of epoch 5/20 class : 0.203 - acc class : 94.53 [bs:128]
90/111 of epoch 5/20 class : 0.157 - acc class : 96.09 [bs:128]
Accuracies on val: class : 95.91
Accuracies on test: class : 73.83
New epoch - lr: 0.01
0/111 of epoch 6/20 class : 0.103 - acc class : 98.44 [bs:128]
30/111 of epoch 6/20 class : 0.128 - acc class : 96.09 [bs:128]
60/111 of epoch 6/20 class : 0.125 - acc class : 96.09 [bs:128]
90/111 of epoch 6/20 class : 0.152 - acc class : 94.53 [bs:128]
Accuracies on val: class : 94.54
Accuracies on test: class : 74.37
New epoch - lr: 0.01
0/111 of epoch 7/20 class : 0.139 - acc class : 95.31 [bs:128]
30/111 of epoch 7/20 class : 0.087 - acc class : 96.09 [bs:128]
60/111 of epoch 7/20 class : 0.058 - acc class : 100.00 [bs:128]
90/111 of epoch 7/20 class : 0.085 - acc class : 97.66 [bs:128]
Accuracies on val: class : 95.41
Accuracies on test: class : 80.76
New epoch - lr: 0.01
0/111 of epoch 8/20 class : 0.035 - acc class : 100.00 [bs:128]
30/111 of epoch 8/20 class : 0.118 - acc class : 95.31 [bs:128]
60/111 of epoch 8/20 class : 0.052 - acc class : 98.44 [bs:128]
90/111 of epoch 8/20 class : 0.121 - acc class : 95.31 [bs:128]
Accuracies on val: class : 95.04
Accuracies on test: class : 78.03
New epoch - lr: 0.01
0/111 of epoch 9/20 class : 0.035 - acc class : 99.22 [bs:128]
30/111 of epoch 9/20 class : 0.131 - acc class : 96.88 [bs:128]
60/111 of epoch 9/20 class : 0.041 - acc class : 100.00 [bs:128]
90/111 of epoch 9/20 class : 0.092 - acc class : 98.44 [bs:128]
Accuracies on val: class : 94.29
Accuracies on test: class : 73.73
New epoch - lr: 0.01
0/111 of epoch 10/20 class : 0.033 - acc class : 99.22 [bs:128]
30/111 of epoch 10/20 class : 0.071 - acc class : 97.66 [bs:128]
60/111 of epoch 10/20 class : 0.042 - acc class : 99.22 [bs:128]
90/111 of epoch 10/20 class : 0.035 - acc class : 98.44 [bs:128]
Accuracies on val: class : 94.91
Accuracies on test: class : 78.96
New epoch - lr: 0.01
0/111 of epoch 11/20 class : 0.095 - acc class : 96.09 [bs:128]
30/111 of epoch 11/20 class : 0.054 - acc class : 98.44 [bs:128]
60/111 of epoch 11/20 class : 0.086 - acc class : 96.09 [bs:128]
90/111 of epoch 11/20 class : 0.093 - acc class : 97.66 [bs:128]
Accuracies on val: class : 94.42
Accuracies on test: class : 81.98
New epoch - lr: 0.01
0/111 of epoch 12/20 class : 0.029 - acc class : 100.00 [bs:128]
30/111 of epoch 12/20 class : 0.024 - acc class : 100.00 [bs:128]
60/111 of epoch 12/20 class : 0.045 - acc class : 99.22 [bs:128]
90/111 of epoch 12/20 class : 0.122 - acc class : 97.66 [bs:128]
Accuracies on val: class : 95.41
Accuracies on test: class : 80.13
New epoch - lr: 0.01
0/111 of epoch 13/20 class : 0.008 - acc class : 100.00 [bs:128]
30/111 of epoch 13/20 class : 0.021 - acc class : 99.22 [bs:128]
60/111 of epoch 13/20 class : 0.036 - acc class : 98.44 [bs:128]
90/111 of epoch 13/20 class : 0.017 - acc class : 100.00 [bs:128]
Accuracies on val: class : 94.04
Accuracies on test: class : 78.81
New epoch - lr: 0.01
0/111 of epoch 14/20 class : 0.067 - acc class : 97.66 [bs:128]
30/111 of epoch 14/20 class : 0.024 - acc class : 99.22 [bs:128]
60/111 of epoch 14/20 class : 0.015 - acc class : 100.00 [bs:128]
90/111 of epoch 14/20 class : 0.009 - acc class : 100.00 [bs:128]
Accuracies on val: class : 95.53
Accuracies on test: class : 82.23
New epoch - lr: 0.01
0/111 of epoch 15/20 class : 0.024 - acc class : 100.00 [bs:128]
30/111 of epoch 15/20 class : 0.018 - acc class : 100.00 [bs:128]
60/111 of epoch 15/20 class : 0.009 - acc class : 100.00 [bs:128]
90/111 of epoch 15/20 class : 0.013 - acc class : 100.00 [bs:128]
Accuracies on val: class : 94.91
Accuracies on test: class : 78.91
New epoch - lr: 0.01
0/111 of epoch 16/20 class : 0.019 - acc class : 100.00 [bs:128]
30/111 of epoch 16/20 class : 0.005 - acc class : 100.00 [bs:128]
60/111 of epoch 16/20 class : 0.024 - acc class : 99.22 [bs:128]
90/111 of epoch 16/20 class : 0.017 - acc class : 100.00 [bs:128]
Accuracies on val: class : 93.30
Accuracies on test: class : 73.10
New epoch - lr: 0.0001
0/111 of epoch 17/20 class : 0.069 - acc class : 98.44 [bs:128]
30/111 of epoch 17/20 class : 0.028 - acc class : 98.44 [bs:128]
60/111 of epoch 17/20 class : 0.019 - acc class : 99.22 [bs:128]
90/111 of epoch 17/20 class : 0.006 - acc class : 100.00 [bs:128]
Accuracies on val: class : 95.66
Accuracies on test: class : 81.15
New epoch - lr: 0.001
0/111 of epoch 18/20 class : 0.006 - acc class : 100.00 [bs:128]
30/111 of epoch 18/20 class : 0.006 - acc class : 100.00 [bs:128]
60/111 of epoch 18/20 class : 0.011 - acc class : 100.00 [bs:128]
90/111 of epoch 18/20 class : 0.050 - acc class : 99.22 [bs:128]
Accuracies on val: class : 95.78
Accuracies on test: class : 80.32
New epoch - lr: 0.001
0/111 of epoch 19/20 class : 0.035 - acc class : 99.22 [bs:128]
30/111 of epoch 19/20 class : 0.014 - acc class : 100.00 [bs:128]
60/111 of epoch 19/20 class : 0.018 - acc class : 99.22 [bs:128]
90/111 of epoch 19/20 class : 0.014 - acc class : 100.00 [bs:128]
Accuracies on val: class : 95.78
Accuracies on test: class : 82.23
New epoch - lr: 0.001
0/111 of epoch 20/20 class : 0.011 - acc class : 100.00 [bs:128]
30/111 of epoch 20/20 class : 0.005 - acc class : 100.00 [bs:128]
60/111 of epoch 20/20 class : 0.006 - acc class : 100.00 [bs:128]
90/111 of epoch 20/20 class : 0.062 - acc class : 98.44 [bs:128]
Accuracies on val: class : 95.53
Accuracies on test: class : 82.62
Best val 0.959057, corresponding test 0.738281 - best test: 0.826172, best epoch: 4
It took 443.576
